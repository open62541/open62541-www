<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Working with Objects and Object Types &mdash; open62541 1.4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=02f2166e"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Adding Methods to Objects" href="tutorial_server_method.html" />
    <link rel="prev" title="Working with Variable Types" href="tutorial_server_variabletype.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="toc.html" class="icon icon-home">
            open62541
              <img src="_static/open62541_html.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_concepts.html">Core Concepts of OPC UA</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building open62541</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="pubsub.html">PubSub</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial_datatypes.html">Working with Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_firststeps.html">Building a Simple Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_variable.html">Adding Variables to a Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_datasource.html">Connecting a Variable with a Physical Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_variabletype.html">Working with Variable Types</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Working with Objects and Object Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-objects-to-structure-information-models">Using objects to structure information models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#object-types-type-hierarchies-and-instantiation">Object types, type hierarchies and instantiation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_method.html">Adding Methods to Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_monitoreditems.html">Observing Attributes with Local MonitoredItems</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_events.html">Generating events</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_alarms_conditions.html">Using Alarms and Conditions Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_client_firststeps.html">Building a Simple Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_pubsub_publish.html">Working with Publish/Subscribe</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_pubsub_subscribe.html">Subscribing Fields</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodeset_compiler.html">XML Nodeset Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="statuscodes.html">StatusCodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugin.html">Plugin API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">open62541</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="toc.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Working with Objects and Object Types</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial_server_object.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="working-with-objects-and-object-types">
<h1>Working with Objects and Object Types<a class="headerlink" href="#working-with-objects-and-object-types" title="Link to this heading">¶</a></h1>
<section id="using-objects-to-structure-information-models">
<h2>Using objects to structure information models<a class="headerlink" href="#using-objects-to-structure-information-models" title="Link to this heading">¶</a></h2>
<p>Assume a situation where we want to model a set of pumps and their runtime
state in an OPC UA information model. Of course, all pump representations
should follow the same basic structure, For example, we might have graphical
representation of pumps in a SCADA visualisation that shall be resuable for
all pumps.</p>
<p>Following the object-oriented programming paradigm, every pump is represented
by an object with the following layout:</p>
<div class="graphviz"><img src="_images/graphviz-636571c8f167f01b140015909e18c76e3e304889.png" alt="digraph tree {

fixedsize=true;
node [width=2, height=0, shape=box, fillcolor=&quot;#E5E5E5&quot;, concentrate=true]

node_root [label=&lt; &lt;I&gt;ObjectNode&lt;/I&gt;&lt;BR/&gt;Pump &gt;]

{ rank=same
  point_1 [shape=point]
  node_1 [label=&lt; &lt;I&gt;VariableNode&lt;/I&gt;&lt;BR/&gt;ManufacturerName &gt;] }
node_root -&gt; point_1 [arrowhead=none]
point_1 -&gt; node_1 [label=&quot;hasComponent&quot;]

{ rank=same
  point_2 [shape=point]
  node_2 [label=&lt; &lt;I&gt;VariableNode&lt;/I&gt;&lt;BR/&gt;ModelName &gt;] }
point_1 -&gt; point_2 [arrowhead=none]
point_2 -&gt; node_2 [label=&quot;hasComponent&quot;]

{  rank=same
   point_4 [shape=point]
   node_4 [label=&lt; &lt;I&gt;VariableNode&lt;/I&gt;&lt;BR/&gt;Status &gt;] }
point_2 -&gt; point_4 [arrowhead=none]
point_4 -&gt; node_4 [label=&quot;hasComponent&quot;]

{  rank=same
   point_5 [shape=point]
   node_5 [label=&lt; &lt;I&gt;VariableNode&lt;/I&gt;&lt;BR/&gt;MotorRPM &gt;] }
point_4 -&gt; point_5 [arrowhead=none]
point_5 -&gt; node_5 [label=&quot;hasComponent&quot;]

}" class="graphviz" /></div>
<p>The following code manually defines a pump and its member variables. We omit
setting constraints on the variable values as this is not the focus of this
tutorial and was already covered.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">manuallyDefinePump</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">pumpId</span><span class="p">;</span><span class="w"> </span><span class="cm">/* get the nodeid assigned by the server */</span>
<span class="w">    </span><span class="n">UA_ObjectAttributes</span><span class="w"> </span><span class="n">oAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_ObjectAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">oAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Pump (Manual)&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_addObjectNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span>
<span class="w">                            </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_OBJECTSFOLDER</span><span class="p">),</span>
<span class="w">                            </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_ORGANIZES</span><span class="p">),</span>
<span class="w">                            </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Pump (Manual)&quot;</span><span class="p">),</span>
<span class="w">                            </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_BASEOBJECTTYPE</span><span class="p">),</span>
<span class="w">                            </span><span class="n">oAttr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pumpId</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_VariableAttributes</span><span class="w"> </span><span class="n">mnAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_VariableAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_String</span><span class="w"> </span><span class="n">manufacturerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_STRING</span><span class="p">(</span><span class="s">&quot;Pump King Ltd.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Variant_setScalar</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mnAttr</span><span class="p">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">manufacturerName</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_STRING</span><span class="p">]);</span>
<span class="w">    </span><span class="n">mnAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ManufacturerName&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_addVariableNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">pumpId</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ManufacturerName&quot;</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_BASEDATAVARIABLETYPE</span><span class="p">),</span>
<span class="w">                              </span><span class="n">mnAttr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_VariableAttributes</span><span class="w"> </span><span class="n">modelAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_VariableAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_String</span><span class="w"> </span><span class="n">modelName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_STRING</span><span class="p">(</span><span class="s">&quot;Mega Pump 3000&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Variant_setScalar</span><span class="p">(</span><span class="o">&amp;</span><span class="n">modelAttr</span><span class="p">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">modelName</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_STRING</span><span class="p">]);</span>
<span class="w">    </span><span class="n">modelAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ModelName&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_addVariableNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">pumpId</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ModelName&quot;</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_BASEDATAVARIABLETYPE</span><span class="p">),</span>
<span class="w">                              </span><span class="n">modelAttr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_VariableAttributes</span><span class="w"> </span><span class="n">statusAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_VariableAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Variant_setScalar</span><span class="p">(</span><span class="o">&amp;</span><span class="n">statusAttr</span><span class="p">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BOOLEAN</span><span class="p">]);</span>
<span class="w">    </span><span class="n">statusAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Status&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_addVariableNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">pumpId</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Status&quot;</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_BASEDATAVARIABLETYPE</span><span class="p">),</span>
<span class="w">                              </span><span class="n">statusAttr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_VariableAttributes</span><span class="w"> </span><span class="n">rpmAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_VariableAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Double</span><span class="w"> </span><span class="n">rpm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">50.0</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Variant_setScalar</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rpmAttr</span><span class="p">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">rpm</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DOUBLE</span><span class="p">]);</span>
<span class="w">    </span><span class="n">rpmAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MotorRPM&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_addVariableNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">pumpId</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MotorRPMs&quot;</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_BASEDATAVARIABLETYPE</span><span class="p">),</span>
<span class="w">                              </span><span class="n">rpmAttr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="object-types-type-hierarchies-and-instantiation">
<h2>Object types, type hierarchies and instantiation<a class="headerlink" href="#object-types-type-hierarchies-and-instantiation" title="Link to this heading">¶</a></h2>
<p>Building up each object manually requires us to write a lot of code.
Furthermore, there is no way for clients to detect that an object represents
a pump. (We might use naming conventions or similar to detect pumps. But
that’s not exactly a clean solution.) Furthermore, we might have more devices
than just pumps. And we require all devices to share some common structure.
The solution is to define ObjectTypes in a hierarchy with inheritance
relations.</p>
<div class="graphviz"><img src="_images/graphviz-c39dc775253d56235473b672a09ce76464bb3b4d.png" alt="digraph tree {

fixedsize=true;
node [width=2, height=0, shape=box, fillcolor=&quot;#E5E5E5&quot;, concentrate=true]

node_root [label=&lt; &lt;I&gt;ObjectTypeNode&lt;/I&gt;&lt;BR/&gt;Device &gt;]

{ rank=same
  point_1 [shape=point]
  node_1 [label=&lt; &lt;I&gt;VariableNode&lt;/I&gt;&lt;BR/&gt;ManufacturerName&lt;BR/&gt;(mandatory) &gt;] }
node_root -&gt; point_1 [arrowhead=none]
point_1 -&gt; node_1 [label=&quot;hasComponent&quot;]

{ rank=same
  point_2 [shape=point]
  node_2 [label=&lt; &lt;I&gt;VariableNode&lt;/I&gt;&lt;BR/&gt;ModelName &gt;] }
point_1 -&gt; point_2 [arrowhead=none]
point_2 -&gt; node_2 [label=&quot;hasComponent&quot;]

{  rank=same
   point_3 [shape=point]
   node_3 [label=&lt; &lt;I&gt;ObjectTypeNode&lt;/I&gt;&lt;BR/&gt;Pump &gt;] }
point_2 -&gt; point_3 [arrowhead=none]
point_3 -&gt; node_3 [label=&quot;hasSubtype&quot;]

{  rank=same
   point_4 [shape=point]
   node_4 [label=&lt; &lt;I&gt;VariableNode&lt;/I&gt;&lt;BR/&gt;Status&lt;BR/&gt;(mandatory) &gt;] }
node_3 -&gt; point_4 [arrowhead=none]
point_4 -&gt; node_4 [label=&quot;hasComponent&quot;]

{  rank=same
   point_5 [shape=point]
   node_5 [label=&lt; &lt;I&gt;VariableNode&lt;/I&gt;&lt;BR/&gt;MotorRPM &gt;] }
point_4 -&gt; point_5 [arrowhead=none]
point_5 -&gt; node_5 [label=&quot;hasComponent&quot;]

}" class="graphviz" /></div>
<p>Children that are marked mandatory are automatically instantiated together
with the parent object. This is indicated by a <cite>hasModellingRule</cite> reference
to an object that representes the <cite>mandatory</cite> modelling rule.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* predefined identifier for later use */</span>
<span class="n">UA_NodeId</span><span class="w"> </span><span class="n">pumpTypeId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEIDTYPE_NUMERIC</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">1001</span><span class="p">}};</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">defineObjectTypes</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Define the object type for &quot;Device&quot; */</span>
<span class="w">    </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">deviceTypeId</span><span class="p">;</span><span class="w"> </span><span class="cm">/* get the nodeid assigned by the server */</span>
<span class="w">    </span><span class="n">UA_ObjectTypeAttributes</span><span class="w"> </span><span class="n">dtAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_ObjectTypeAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">dtAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DeviceType&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_addObjectTypeNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span>
<span class="w">                                </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_BASEOBJECTTYPE</span><span class="p">),</span>
<span class="w">                                </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASSUBTYPE</span><span class="p">),</span>
<span class="w">                                </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DeviceType&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">dtAttr</span><span class="p">,</span>
<span class="w">                                </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">deviceTypeId</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_VariableAttributes</span><span class="w"> </span><span class="n">mnAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_VariableAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">mnAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ManufacturerName&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">manufacturerNameId</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Server_addVariableNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">deviceTypeId</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ManufacturerName&quot;</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_BASEDATAVARIABLETYPE</span><span class="p">),</span>
<span class="w">                              </span><span class="n">mnAttr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">manufacturerNameId</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Make the manufacturer name mandatory */</span>
<span class="w">    </span><span class="n">UA_Server_addReference</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">manufacturerNameId</span><span class="p">,</span>
<span class="w">                           </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASMODELLINGRULE</span><span class="p">),</span>
<span class="w">                           </span><span class="n">UA_EXPANDEDNODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_MODELLINGRULE_MANDATORY</span><span class="p">),</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>


<span class="w">    </span><span class="n">UA_VariableAttributes</span><span class="w"> </span><span class="n">modelAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_VariableAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">modelAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ModelName&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_addVariableNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">deviceTypeId</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ModelName&quot;</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_BASEDATAVARIABLETYPE</span><span class="p">),</span>
<span class="w">                              </span><span class="n">modelAttr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* Define the object type for &quot;Pump&quot; */</span>
<span class="w">    </span><span class="n">UA_ObjectTypeAttributes</span><span class="w"> </span><span class="n">ptAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_ObjectTypeAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">ptAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PumpType&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_addObjectTypeNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">pumpTypeId</span><span class="p">,</span>
<span class="w">                                </span><span class="n">deviceTypeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASSUBTYPE</span><span class="p">),</span>
<span class="w">                                </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PumpType&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">ptAttr</span><span class="p">,</span>
<span class="w">                                </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_VariableAttributes</span><span class="w"> </span><span class="n">statusAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_VariableAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">statusAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Status&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">statusAttr</span><span class="p">.</span><span class="n">valueRank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_VALUERANK_SCALAR</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">statusId</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Server_addVariableNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">pumpTypeId</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Status&quot;</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_BASEDATAVARIABLETYPE</span><span class="p">),</span>
<span class="w">                              </span><span class="n">statusAttr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">statusId</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Make the status variable mandatory */</span>
<span class="w">    </span><span class="n">UA_Server_addReference</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">statusId</span><span class="p">,</span>
<span class="w">                           </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASMODELLINGRULE</span><span class="p">),</span>
<span class="w">                           </span><span class="n">UA_EXPANDEDNODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_MODELLINGRULE_MANDATORY</span><span class="p">),</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_VariableAttributes</span><span class="w"> </span><span class="n">rpmAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_VariableAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">rpmAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MotorRPM&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">rpmAttr</span><span class="p">.</span><span class="n">valueRank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_VALUERANK_SCALAR</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Server_addVariableNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">pumpTypeId</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MotorRPMs&quot;</span><span class="p">),</span>
<span class="w">                              </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_BASEDATAVARIABLETYPE</span><span class="p">),</span>
<span class="w">                              </span><span class="n">rpmAttr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now we add the derived ObjectType for the pump that inherits from the device
object type. The resulting object contains all mandatory child variables.
These are simply copied over from the object type. The object has a reference
of type <code class="docutils literal notranslate"><span class="pre">hasTypeDefinition</span></code> to the object type, so that clients can detect
the type-instance relation at runtime.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">addPumpObjectInstance</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_ObjectAttributes</span><span class="w"> </span><span class="n">oAttr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_ObjectAttributes_default</span><span class="p">;</span>
<span class="w">    </span><span class="n">oAttr</span><span class="p">.</span><span class="n">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_addObjectNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span>
<span class="w">                            </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_OBJECTSFOLDER</span><span class="p">),</span>
<span class="w">                            </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_ORGANIZES</span><span class="p">),</span>
<span class="w">                            </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">),</span>
<span class="w">                            </span><span class="n">pumpTypeId</span><span class="p">,</span><span class="w"> </span><span class="cm">/* this refers to the object type</span>
<span class="cm">                                           identifier */</span>
<span class="w">                            </span><span class="n">oAttr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Often we want to run a constructor function on a new object. This is
especially useful when an object is instantiated at runtime (with the
AddNodes service) and the integration with an underlying process cannot be
manually defined. In the following constructor example, we simply set the
pump status to on.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="nf">pumpTypeConstructor</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">sessionId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">typeId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">typeContext</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="n">nodeContext</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_LOG_INFO</span><span class="p">(</span><span class="n">UA_Log_Stdout</span><span class="p">,</span><span class="w"> </span><span class="n">UA_LOGCATEGORY_USERLAND</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;New pump created&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* Find the NodeId of the status child variable */</span>
<span class="w">    </span><span class="n">UA_RelativePathElement</span><span class="w"> </span><span class="n">rpe</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_RelativePathElement_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rpe</span><span class="p">);</span>
<span class="w">    </span><span class="n">rpe</span><span class="p">.</span><span class="n">referenceTypeId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">);</span>
<span class="w">    </span><span class="n">rpe</span><span class="p">.</span><span class="n">isInverse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="n">rpe</span><span class="p">.</span><span class="n">includeSubtypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="n">rpe</span><span class="p">.</span><span class="n">targetName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Status&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_BrowsePath</span><span class="w"> </span><span class="n">bp</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_BrowsePath_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bp</span><span class="p">);</span>
<span class="w">    </span><span class="n">bp</span><span class="p">.</span><span class="n">startingNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">nodeId</span><span class="p">;</span>
<span class="w">    </span><span class="n">bp</span><span class="p">.</span><span class="n">relativePath</span><span class="p">.</span><span class="n">elementsSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">bp</span><span class="p">.</span><span class="n">relativePath</span><span class="p">.</span><span class="n">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">rpe</span><span class="p">;</span>

<span class="w">    </span><span class="n">UA_BrowsePathResult</span><span class="w"> </span><span class="n">bpr</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">UA_Server_translateBrowsePathToNodeIds</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bp</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">bpr</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">UA_STATUSCODE_GOOD</span><span class="w"> </span><span class="o">||</span>
<span class="w">       </span><span class="n">bpr</span><span class="p">.</span><span class="n">targetsSize</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">bpr</span><span class="p">.</span><span class="n">statusCode</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Set the status value */</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Variant</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Variant_setScalar</span><span class="p">(</span><span class="o">&amp;</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BOOLEAN</span><span class="p">]);</span>
<span class="w">    </span><span class="n">UA_Server_writeValue</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">bpr</span><span class="p">.</span><span class="n">targets</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">targetId</span><span class="p">.</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_BrowsePathResult_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bpr</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* At this point we could replace the node context .. */</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">UA_STATUSCODE_GOOD</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">addPumpTypeConstructor</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_NodeTypeLifecycle</span><span class="w"> </span><span class="n">lifecycle</span><span class="p">;</span>
<span class="w">    </span><span class="n">lifecycle</span><span class="p">.</span><span class="n">constructor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pumpTypeConstructor</span><span class="p">;</span>
<span class="w">    </span><span class="n">lifecycle</span><span class="p">.</span><span class="n">destructor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Server_setNodeTypeLifecycle</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">pumpTypeId</span><span class="p">,</span><span class="w"> </span><span class="n">lifecycle</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It follows the main server code, making use of the above definitions.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_Server_new</span><span class="p">();</span>

<span class="w">    </span><span class="n">manuallyDefinePump</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="n">defineObjectTypes</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="n">addPumpObjectInstance</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pump2&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">addPumpObjectInstance</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pump3&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">addPumpTypeConstructor</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="n">addPumpObjectInstance</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pump4&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">addPumpObjectInstance</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pump5&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_Server_runUntilInterrupt</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_delete</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial_server_variabletype.html" class="btn btn-neutral float-left" title="Working with Variable Types" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial_server_method.html" class="btn btn-neutral float-right" title="Adding Methods to Objects" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>