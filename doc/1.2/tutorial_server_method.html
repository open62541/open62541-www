

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Adding Methods to Objects &mdash; open62541 1.2.0-5-gcc3a3d396-dirty documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Observing Attributes with Local MonitoredItems" href="tutorial_server_monitoreditems.html" />
    <link rel="prev" title="Working with Objects and Object Types" href="tutorial_server_object.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="toc.html" class="icon icon-home"> open62541
          

          
            
            <img src="_static/open62541_html.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building open62541</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installing open62541</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial_datatypes.html">Working with Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_firststeps.html">Building a Simple Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_variable.html">Adding Variables to a Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_datasource.html">Connecting a Variable with a Physical Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_variabletype.html">Working with Variable Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_object.html">Working with Objects and Object Types</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Adding Methods to Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-hello-world-method">Example: Hello World Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#increase-array-values-method">Increase Array Values Method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_monitoreditems.html">Observing Attributes with Local MonitoredItems</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_events.html">Generating events</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_server_alarms_conditions.html">Using Alarms and Conditions Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_client_firststeps.html">Building a Simple Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_pubsub_publish.html">Working with Publish/Subscribe</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="protocol.html">Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="services.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodestore.html">Information Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodeset_compiler.html">XML Nodeset Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="internal.html">Internals</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">open62541</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="toc.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Adding Methods to Objects</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/tutorial_server_method.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="adding-methods-to-objects">
<h1>Adding Methods to Objects<a class="headerlink" href="#adding-methods-to-objects" title="Permalink to this headline">¶</a></h1>
<p>An object in an OPC UA information model may contain methods similar to
objects in a programming language. Methods are represented by a MethodNode.
Note that several objects may reference the same MethodNode. When an object
type is instantiated, a reference to the method is added instead of copying
the MethodNode. Therefore, the identifier of the context object is always
explicitly stated when a method is called.</p>
<p>The method callback takes as input a custom data pointer attached to the
method node, the identifier of the object from which the method is called,
and two arrays for the input and output arguments. The input and output
arguments are all of type <a class="reference internal" href="types.html#variant"><span class="std std-ref">Variant</span></a>. Each variant may in turn contain a
(multi-dimensional) array or scalar of any data type.</p>
<p>Constraints for the method arguments are defined in terms of data type, value
rank and array dimension (similar to variable definitions). The argument
definitions are stored in child VariableNodes of the MethodNode with the
respective BrowseNames <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">&quot;InputArguments&quot;)</span></code> and <code class="docutils literal notranslate"><span class="pre">(0,</span>
<span class="pre">&quot;OutputArguments&quot;)</span></code>.</p>
<div class="section" id="example-hello-world-method">
<h2>Example: Hello World Method<a class="headerlink" href="#example-hello-world-method" title="Permalink to this headline">¶</a></h2>
<p>The method takes a string scalar and returns a string scalar with “Hello ”
prepended. The type and length of the input arguments is checked internally
by the SDK, so that we don’t have to verify the arguments in the callback.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;open62541/client_config_default.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;open62541/plugin/log_stdout.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;open62541/server.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;open62541/server_config_default.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>

<span class="k">static</span> <span class="n">UA_StatusCode</span>
<span class="n">helloWorldMethodCallback</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                         <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">sessionHandle</span><span class="p">,</span>
                         <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">methodId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">methodContext</span><span class="p">,</span>
                         <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">objectId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">objectContext</span><span class="p">,</span>
                         <span class="kt">size_t</span> <span class="n">inputSize</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Variant</span> <span class="o">*</span><span class="n">input</span><span class="p">,</span>
                         <span class="kt">size_t</span> <span class="n">outputSize</span><span class="p">,</span> <span class="n">UA_Variant</span> <span class="o">*</span><span class="n">output</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">UA_String</span> <span class="o">*</span><span class="n">inputStr</span> <span class="o">=</span> <span class="p">(</span><span class="n">UA_String</span><span class="o">*</span><span class="p">)</span><span class="n">input</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
    <span class="n">UA_String</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">UA_STRING_ALLOC</span><span class="p">(</span><span class="s">&quot;Hello &quot;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputStr</span><span class="o">-&gt;</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">UA_Byte</span> <span class="o">*</span><span class="p">)</span><span class="n">UA_realloc</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">tmp</span><span class="p">.</span><span class="n">length</span> <span class="o">+</span> <span class="n">inputStr</span><span class="o">-&gt;</span><span class="n">length</span><span class="p">);</span>
        <span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tmp</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">tmp</span><span class="p">.</span><span class="n">length</span><span class="p">],</span> <span class="n">inputStr</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">,</span> <span class="n">inputStr</span><span class="o">-&gt;</span><span class="n">length</span><span class="p">);</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">length</span> <span class="o">+=</span> <span class="n">inputStr</span><span class="o">-&gt;</span><span class="n">length</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">UA_Variant_setScalarCopy</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tmp</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_STRING</span><span class="p">]);</span>
    <span class="n">UA_String_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tmp</span><span class="p">);</span>
    <span class="n">UA_LOG_INFO</span><span class="p">(</span><span class="n">UA_Log_Stdout</span><span class="p">,</span> <span class="n">UA_LOGCATEGORY_SERVER</span><span class="p">,</span> <span class="s">&quot;Hello World was called&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">UA_STATUSCODE_GOOD</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span>
<span class="n">addHellWorldMethod</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">UA_Argument</span> <span class="n">inputArgument</span><span class="p">;</span>
    <span class="n">UA_Argument_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">inputArgument</span><span class="p">);</span>
    <span class="n">inputArgument</span><span class="p">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span> <span class="s">&quot;A String&quot;</span><span class="p">);</span>
    <span class="n">inputArgument</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">UA_STRING</span><span class="p">(</span><span class="s">&quot;MyInput&quot;</span><span class="p">);</span>
    <span class="n">inputArgument</span><span class="p">.</span><span class="n">dataType</span> <span class="o">=</span> <span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_STRING</span><span class="p">].</span><span class="n">typeId</span><span class="p">;</span>
    <span class="n">inputArgument</span><span class="p">.</span><span class="n">valueRank</span> <span class="o">=</span> <span class="n">UA_VALUERANK_SCALAR</span><span class="p">;</span>

    <span class="n">UA_Argument</span> <span class="n">outputArgument</span><span class="p">;</span>
    <span class="n">UA_Argument_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">outputArgument</span><span class="p">);</span>
    <span class="n">outputArgument</span><span class="p">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span> <span class="s">&quot;A String&quot;</span><span class="p">);</span>
    <span class="n">outputArgument</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">UA_STRING</span><span class="p">(</span><span class="s">&quot;MyOutput&quot;</span><span class="p">);</span>
    <span class="n">outputArgument</span><span class="p">.</span><span class="n">dataType</span> <span class="o">=</span> <span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_STRING</span><span class="p">].</span><span class="n">typeId</span><span class="p">;</span>
    <span class="n">outputArgument</span><span class="p">.</span><span class="n">valueRank</span> <span class="o">=</span> <span class="n">UA_VALUERANK_SCALAR</span><span class="p">;</span>

    <span class="n">UA_MethodAttributes</span> <span class="n">helloAttr</span> <span class="o">=</span> <span class="n">UA_MethodAttributes_default</span><span class="p">;</span>
    <span class="n">helloAttr</span><span class="p">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="s">&quot;Say `Hello World`&quot;</span><span class="p">);</span>
    <span class="n">helloAttr</span><span class="p">.</span><span class="n">displayName</span> <span class="o">=</span> <span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span>
    <span class="n">helloAttr</span><span class="p">.</span><span class="n">executable</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">helloAttr</span><span class="p">.</span><span class="n">userExecutable</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">UA_Server_addMethodNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">62541</span><span class="p">),</span>
                            <span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">UA_NS0ID_OBJECTSFOLDER</span><span class="p">),</span>
                            <span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">),</span>
                            <span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;hello world&quot;</span><span class="p">),</span>
                            <span class="n">helloAttr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">helloWorldMethodCallback</span><span class="p">,</span>
                            <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inputArgument</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">outputArgument</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="increase-array-values-method">
<h2>Increase Array Values Method<a class="headerlink" href="#increase-array-values-method" title="Permalink to this headline">¶</a></h2>
<p>The method takes an array of 5 integers and a scalar as input. It returns a
copy of the array with every entry increased by the scalar.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="n">UA_StatusCode</span>
<span class="n">IncInt32ArrayMethodCallback</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">sessionId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">methodId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">methodContext</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">UA_NodeId</span> <span class="o">*</span><span class="n">objectId</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">objectContext</span><span class="p">,</span>
                            <span class="kt">size_t</span> <span class="n">inputSize</span><span class="p">,</span> <span class="k">const</span> <span class="n">UA_Variant</span> <span class="o">*</span><span class="n">input</span><span class="p">,</span>
                            <span class="kt">size_t</span> <span class="n">outputSize</span><span class="p">,</span> <span class="n">UA_Variant</span> <span class="o">*</span><span class="n">output</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">UA_Int32</span> <span class="o">*</span><span class="n">inputArray</span> <span class="o">=</span> <span class="p">(</span><span class="n">UA_Int32</span><span class="o">*</span><span class="p">)</span><span class="n">input</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">data</span><span class="p">;</span>
    <span class="n">UA_Int32</span> <span class="n">delta</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">UA_Int32</span><span class="o">*</span><span class="p">)</span><span class="n">input</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">data</span><span class="p">;</span>

    <span class="cm">/* Copy the input array */</span>
    <span class="n">UA_StatusCode</span> <span class="n">retval</span> <span class="o">=</span> <span class="n">UA_Variant_setArrayCopy</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">inputArray</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
                                                   <span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_INT32</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">retval</span> <span class="o">!=</span> <span class="n">UA_STATUSCODE_GOOD</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">retval</span><span class="p">;</span>

    <span class="cm">/* Increate the elements */</span>
    <span class="n">UA_Int32</span> <span class="o">*</span><span class="n">outputArray</span> <span class="o">=</span> <span class="p">(</span><span class="n">UA_Int32</span><span class="o">*</span><span class="p">)</span><span class="n">output</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">input</span><span class="o">-&gt;</span><span class="n">arrayLength</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">outputArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">UA_STATUSCODE_GOOD</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span>
<span class="n">addIncInt32ArrayMethod</span><span class="p">(</span><span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* Two input arguments */</span>
    <span class="n">UA_Argument</span> <span class="n">inputArguments</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="n">UA_Argument_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">inputArguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="n">inputArguments</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">description</span> <span class="o">=</span> <span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span> <span class="s">&quot;int32[5] array&quot;</span><span class="p">);</span>
    <span class="n">inputArguments</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">name</span> <span class="o">=</span> <span class="n">UA_STRING</span><span class="p">(</span><span class="s">&quot;int32 array&quot;</span><span class="p">);</span>
    <span class="n">inputArguments</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">dataType</span> <span class="o">=</span> <span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_INT32</span><span class="p">].</span><span class="n">typeId</span><span class="p">;</span>
    <span class="n">inputArguments</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">valueRank</span> <span class="o">=</span> <span class="n">UA_VALUERANK_ONE_DIMENSION</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">pInputDimension</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">inputArguments</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">arrayDimensionsSize</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">inputArguments</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">arrayDimensions</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pInputDimension</span><span class="p">;</span>

    <span class="n">UA_Argument_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">inputArguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">inputArguments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">description</span> <span class="o">=</span> <span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span> <span class="s">&quot;int32 delta&quot;</span><span class="p">);</span>
    <span class="n">inputArguments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">name</span> <span class="o">=</span> <span class="n">UA_STRING</span><span class="p">(</span><span class="s">&quot;int32 delta&quot;</span><span class="p">);</span>
    <span class="n">inputArguments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">dataType</span> <span class="o">=</span> <span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_INT32</span><span class="p">].</span><span class="n">typeId</span><span class="p">;</span>
    <span class="n">inputArguments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">valueRank</span> <span class="o">=</span> <span class="n">UA_VALUERANK_SCALAR</span><span class="p">;</span>

    <span class="cm">/* One output argument */</span>
    <span class="n">UA_Argument</span> <span class="n">outputArgument</span><span class="p">;</span>
    <span class="n">UA_Argument_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">outputArgument</span><span class="p">);</span>
    <span class="n">outputArgument</span><span class="p">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span> <span class="s">&quot;int32[5] array&quot;</span><span class="p">);</span>
    <span class="n">outputArgument</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">UA_STRING</span><span class="p">(</span><span class="s">&quot;each entry is incremented by the delta&quot;</span><span class="p">);</span>
    <span class="n">outputArgument</span><span class="p">.</span><span class="n">dataType</span> <span class="o">=</span> <span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_INT32</span><span class="p">].</span><span class="n">typeId</span><span class="p">;</span>
    <span class="n">outputArgument</span><span class="p">.</span><span class="n">valueRank</span> <span class="o">=</span> <span class="n">UA_VALUERANK_ONE_DIMENSION</span><span class="p">;</span>
    <span class="n">UA_UInt32</span> <span class="n">pOutputDimension</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">outputArgument</span><span class="p">.</span><span class="n">arrayDimensionsSize</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">outputArgument</span><span class="p">.</span><span class="n">arrayDimensions</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pOutputDimension</span><span class="p">;</span>

    <span class="cm">/* Add the method node */</span>
    <span class="n">UA_MethodAttributes</span> <span class="n">incAttr</span> <span class="o">=</span> <span class="n">UA_MethodAttributes_default</span><span class="p">;</span>
    <span class="n">incAttr</span><span class="p">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span> <span class="s">&quot;IncInt32ArrayValues&quot;</span><span class="p">);</span>
    <span class="n">incAttr</span><span class="p">.</span><span class="n">displayName</span> <span class="o">=</span> <span class="n">UA_LOCALIZEDTEXT</span><span class="p">(</span><span class="s">&quot;en-US&quot;</span><span class="p">,</span> <span class="s">&quot;IncInt32ArrayValues&quot;</span><span class="p">);</span>
    <span class="n">incAttr</span><span class="p">.</span><span class="n">executable</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">incAttr</span><span class="p">.</span><span class="n">userExecutable</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">UA_Server_addMethodNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">UA_NODEID_STRING</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;IncInt32ArrayValues&quot;</span><span class="p">),</span>
                            <span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">UA_NS0ID_OBJECTSFOLDER</span><span class="p">),</span>
                            <span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">UA_NS0ID_HASCOMPONENT</span><span class="p">),</span>
                            <span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;IncInt32ArrayValues&quot;</span><span class="p">),</span>
                            <span class="n">incAttr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">IncInt32ArrayMethodCallback</span><span class="p">,</span>
                            <span class="mi">2</span><span class="p">,</span> <span class="n">inputArguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">outputArgument</span><span class="p">,</span>
                            <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It follows the main server code, making use of the above definitions.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="k">volatile</span> <span class="n">UA_Boolean</span> <span class="n">running</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">stopHandler</span><span class="p">(</span><span class="kt">int</span> <span class="n">sign</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">UA_LOG_INFO</span><span class="p">(</span><span class="n">UA_Log_Stdout</span><span class="p">,</span> <span class="n">UA_LOGCATEGORY_SERVER</span><span class="p">,</span> <span class="s">&quot;received ctrl-c&quot;</span><span class="p">);</span>
    <span class="n">running</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">stopHandler</span><span class="p">);</span>
    <span class="n">signal</span><span class="p">(</span><span class="n">SIGTERM</span><span class="p">,</span> <span class="n">stopHandler</span><span class="p">);</span>

    <span class="n">UA_Server</span> <span class="o">*</span><span class="n">server</span> <span class="o">=</span> <span class="n">UA_Server_new</span><span class="p">();</span>
    <span class="n">UA_ServerConfig_setDefault</span><span class="p">(</span><span class="n">UA_Server_getConfig</span><span class="p">(</span><span class="n">server</span><span class="p">));</span>

    <span class="n">addHellWorldMethod</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
    <span class="n">addIncInt32ArrayMethod</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>

    <span class="n">UA_StatusCode</span> <span class="n">retval</span> <span class="o">=</span> <span class="n">UA_Server_run</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">running</span><span class="p">);</span>

    <span class="n">UA_Server_delete</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">retval</span> <span class="o">==</span> <span class="n">UA_STATUSCODE_GOOD</span> <span class="o">?</span> <span class="nl">EXIT_SUCCESS</span> <span class="p">:</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="tutorial_server_monitoreditems.html" class="btn btn-neutral float-right" title="Observing Attributes with Local MonitoredItems" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="tutorial_server_object.html" class="btn btn-neutral float-left" title="Working with Objects and Object Types" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2016, The open62541 authors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>