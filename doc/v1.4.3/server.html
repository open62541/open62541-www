<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Server &mdash; open62541 1.4.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=a68a9277"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Client" href="client.html" />
    <link rel="prev" title="Data Types" href="types.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="toc.html" class="icon icon-home">
            open62541
              <img src="_static/open62541_html.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_concepts.html">Core Concepts of OPC UA</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building open62541</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Data Types</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#server-configuration">Server Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#server-description">Server Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server-lifecycle">Server Lifecycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rule-handling">Rule Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-data-types">Custom Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eventloop">EventLoop</a></li>
<li class="toctree-l3"><a class="reference internal" href="#networking">Networking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#security-and-encryption">Security and Encryption</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nodes-and-node-lifecycle">Nodes and Node Lifecycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limits">Limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#async-operations">Async Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#discovery">Discovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="#subscriptions">Subscriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pubsub">PubSub</a></li>
<li class="toctree-l3"><a class="reference internal" href="#historical-access">Historical Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reverse-connect">Reverse Connect</a></li>
<li class="toctree-l3"><a class="reference internal" href="#certificate-password-callback">Certificate Password Callback</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id3">Server Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="#timed-callbacks">Timed Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#session-handling">Session Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-and-writing-node-attributes">Reading and Writing Node Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#browsing">Browsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">Discovery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#registering-at-a-discovery-server">Registering at a Discovery Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#operating-a-discovery-server">Operating a Discovery Server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#information-model-callbacks">Information Model Callbacks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-source-callback">Data Source Callback</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local-monitoreditems">Local MonitoredItems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#method-callbacks">Method Callbacks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#interacting-with-objects">Interacting with Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#node-addition-and-deletion">Node Addition and Deletion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference-management">Reference Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#alarms-conditions-experimental">Alarms &amp; Conditions (Experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update-the-server-certificate-at-runtime">Update the Server Certificate at Runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utility-functions">Utility Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">Async Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#statistics">Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id10">Reverse Connect</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="pubsub.html">PubSub</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodeset_compiler.html">XML Nodeset Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="statuscodes.html">StatusCodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugin.html">Plugin API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">open62541</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="toc.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Server</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/server.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="server">
<span id="id1"></span><h1>Server<a class="headerlink" href="#server" title="Link to this heading">¶</a></h1>
<section id="server-configuration">
<span id="id2"></span><h2>Server Configuration<a class="headerlink" href="#server-configuration" title="Link to this heading">¶</a></h2>
<p>The configuration structure is passed to the server during initialization.
The server expects that the configuration is not modified during runtime.
Currently, only one server can use a configuration at a time. During
shutdown, the server will clean up the parts of the configuration that are
modified at runtime through the provided API.</p>
<p>Examples for configurations are provided in the <code class="docutils literal notranslate"><span class="pre">/plugins</span></code> folder.
The usual usage is as follows:</p>
<ol class="arabic simple">
<li><p>Create a server configuration with default settings as a starting point</p></li>
<li><p>Modifiy the configuration, e.g. by adding a server certificate</p></li>
<li><p>Instantiate a server with it</p></li>
<li><p>After shutdown of the server, clean up the configuration (free memory)</p></li>
</ol>
<p>The <a class="reference internal" href="tutorials.html#tutorials"><span class="std std-ref">Tutorials</span></a> provide a good starting point for this.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">UA_ServerConfig</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">context</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Used to attach custom data to a server config. This can</span>
<span class="cm">                    * then be retrieved e.g. in a callback that forwards a</span>
<span class="cm">                    * pointer to the server. */</span>
<span class="w">    </span><span class="n">UA_Logger</span><span class="w"> </span><span class="o">*</span><span class="n">logging</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Plugin for log output */</span>
</pre></div>
</div>
<section id="server-description">
<h3>Server Description<a class="headerlink" href="#server-description" title="Link to this heading">¶</a></h3>
<p>The description must be internally consistent. The ApplicationUri set in
the ApplicationDescription must match the URI set in the server
certificate.
The applicationType is not just descriptive, it changes the actual
functionality of the server. The RegisterServer service is available only
if the server is a DiscoveryServer and the applicationType is set to the
appropriate value.*/</p>
</section>
<section id="server-lifecycle">
<h3>Server Lifecycle<a class="headerlink" href="#server-lifecycle" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Delay in ms from the shutdown signal (ctrl-c) until the actual shutdown.</span>
<span class="cm"> * Clients need to be able to get a notification ahead of time. */</span>
<span class="n">UA_Double</span><span class="w"> </span><span class="n">shutdownDelay</span><span class="p">;</span>

<span class="cm">/* If an asynchronous server shutdown is used, this callback notifies about</span>
<span class="cm"> * the current lifecycle state (notably the STOPPING -&gt; STOPPED</span>
<span class="cm"> * transition). */</span>
<span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">notifyLifecycleState</span><span class="p">)(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_LifecycleState</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="rule-handling">
<h3>Rule Handling<a class="headerlink" href="#rule-handling" title="Link to this heading">¶</a></h3>
<p>Override the handling of standard-defined behavior. These settings are
used to balance the following contradicting requirements:</p>
<ul class="simple">
<li><p>Strict conformance with the standard (for certification).</p></li>
<li><p>Ensure interoperability with old/non-conforming implementations
encountered in the wild.</p></li>
</ul>
<p>The defaults are set for compatibility with the largest number of OPC UA
vendors (with log warnings activated). Cf. Postel’s Law “be conservative
in what you send, be liberal in what you accept”.</p>
<p>See the section <a class="reference internal" href="common.html#rule-handling"><span class="std std-ref">Rule Handling</span></a> for the possible settings.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Verify that the server sends a timestamp in the request header */</span>
<span class="n">UA_RuleHandling</span><span class="w"> </span><span class="n">verifyRequestTimestamp</span><span class="p">;</span>

<span class="cm">/* Variables (that don&#39;t have a DataType of BaseDataType) must not have an</span>
<span class="cm"> * empty variant value. The default behaviour is to auto-create a matching</span>
<span class="cm"> * zeroed-out value for empty VariableNodes when they are added. */</span>
<span class="n">UA_RuleHandling</span><span class="w"> </span><span class="n">allowEmptyVariables</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="custom-data-types">
<h3>Custom Data Types<a class="headerlink" href="#custom-data-types" title="Link to this heading">¶</a></h3>
<p>The following is a linked list of arrays with custom data types. All data
types that are accessible from here are automatically considered for the
decoding of received messages. Custom data types are not cleaned up
together with the configuration. So it is possible to allocate them on
ROM.</p>
<p>See the section on <a class="reference internal" href="types.html#generic-types"><span class="std std-ref">Generic Type Handling</span></a>. Examples for working with custom
data types are provided in <code class="docutils literal notranslate"><span class="pre">/examples/custom_datatype/</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataTypeArray</span><span class="w"> </span><span class="o">*</span><span class="n">customDataTypes</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the section on <a class="reference internal" href="types.html#generic-types"><span class="std std-ref">Generic Type Handling</span></a>. Examples for working
with custom data types are provided in
<code class="docutils literal notranslate"><span class="pre">/examples/custom_datatype/</span></code>.</p>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
<section id="eventloop">
<h3>EventLoop<a class="headerlink" href="#eventloop" title="Link to this heading">¶</a></h3>
<p>The sever can be plugged into an external EventLoop. Otherwise the
EventLoop is considered to be attached to the server’s lifecycle and will
be destroyed when the config is cleaned up.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_EventLoop</span><span class="w"> </span><span class="o">*</span><span class="n">eventLoop</span><span class="p">;</span>
<span class="n">UA_Boolean</span><span class="w"> </span><span class="n">externalEventLoop</span><span class="p">;</span><span class="w"> </span><span class="cm">/* The EventLoop is not deleted with the config */</span>
</pre></div>
</div>
</section>
<section id="networking">
<h3>Networking<a class="headerlink" href="#networking" title="Link to this heading">¶</a></h3>
<p>The <cite>severUrls</cite> array contains the server URLs like
<cite>opc.tcp://my-server:4840</cite> or <cite>opc.wss://localhost:443</cite>. The URLs are
used both for discovery and to set up the server sockets based on the
defined hostnames (and ports).</p>
<ul class="simple">
<li><p>If the list is empty: Listen on all network interfaces with TCP port 4840.</p></li>
<li><p>If the hostname of a URL is empty: Use the define protocol and port and
listen on all interfaces.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_String</span><span class="w"> </span><span class="o">*</span><span class="n">serverUrls</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">serverUrlsSize</span><span class="p">;</span>
</pre></div>
</div>
<p>The following settings are specific to OPC UA with TCP transport.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">tcpEnabled</span><span class="p">;</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">tcpBufSize</span><span class="p">;</span><span class="w">    </span><span class="cm">/* Max length of sent and received chunks (packets)</span>
<span class="cm">                          * (default: 64kB) */</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">tcpMaxMsgSize</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Max length of messages</span>
<span class="cm">                          * (default: 0 -&gt; unbounded) */</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">tcpMaxChunks</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Max number of chunks per message</span>
<span class="cm">                          * (default: 0 -&gt; unbounded) */</span>
<span class="n">UA_Boolean</span><span class="w"> </span><span class="n">tcpReuseAddr</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="security-and-encryption">
<h3>Security and Encryption<a class="headerlink" href="#security-and-encryption" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">size_t</span><span class="w"> </span><span class="n">securityPoliciesSize</span><span class="p">;</span>
<span class="n">UA_SecurityPolicy</span><span class="o">*</span><span class="w"> </span><span class="n">securityPolicies</span><span class="p">;</span>

<span class="cm">/* Endpoints with combinations of SecurityPolicy and SecurityMode. If the</span>
<span class="cm"> * UserIdentityToken array of the Endpoint is not set, then it will be</span>
<span class="cm"> * filled by the server for all UserTokenPolicies that are configured in the</span>
<span class="cm"> * AccessControl plugin. */</span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">endpointsSize</span><span class="p">;</span>
<span class="n">UA_EndpointDescription</span><span class="w"> </span><span class="o">*</span><span class="n">endpoints</span><span class="p">;</span>

<span class="cm">/* Only allow the following discovery services to be executed on a</span>
<span class="cm"> * SecureChannel with SecurityPolicyNone: GetEndpointsRequest,</span>
<span class="cm"> * FindServersRequest and FindServersOnNetworkRequest.</span>
<span class="cm"> *</span>
<span class="cm"> * Only enable this option if there is no endpoint with SecurityPolicy#None</span>
<span class="cm"> * in the endpoints list. The SecurityPolicy#None must be present in the</span>
<span class="cm"> * securityPolicies list. */</span>
<span class="n">UA_Boolean</span><span class="w"> </span><span class="n">securityPolicyNoneDiscoveryOnly</span><span class="p">;</span>

<span class="cm">/* Allow clients without encryption support to connect with username and password.</span>
<span class="cm"> * This requires to transmit the password in plain text over the network which is</span>
<span class="cm"> * why this option is disabled by default.</span>
<span class="cm"> * Make sure you really need this before enabling plain text passwords. */</span>
<span class="n">UA_Boolean</span><span class="w"> </span><span class="n">allowNonePolicyPassword</span><span class="p">;</span>

<span class="cm">/* Different sets of certificates are trusted for SecureChannel / Session */</span>
<span class="n">UA_CertificateVerification</span><span class="w"> </span><span class="n">secureChannelPKI</span><span class="p">;</span>
<span class="n">UA_CertificateVerification</span><span class="w"> </span><span class="n">sessionPKI</span><span class="p">;</span>
</pre></div>
</div>
<p>See the section for <a class="reference internal" href="plugin_accesscontrol.html#access-control"><span class="std std-ref">access-control
handling</span></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_AccessControl</span><span class="w"> </span><span class="n">accessControl</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="nodes-and-node-lifecycle">
<h3>Nodes and Node Lifecycle<a class="headerlink" href="#nodes-and-node-lifecycle" title="Link to this heading">¶</a></h3>
<p>See the section for <a class="reference internal" href="plugin_nodestore.html#node-lifecycle"><span class="std std-ref">node lifecycle handling</span></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_Nodestore</span><span class="w"> </span><span class="n">nodestore</span><span class="p">;</span>
<span class="n">UA_GlobalNodeLifecycle</span><span class="w"> </span><span class="n">nodeLifecycle</span><span class="p">;</span>
</pre></div>
</div>
<p>Copy the HasModellingRule reference in instances from the type
definition in UA_Server_addObjectNode and UA_Server_addVariableNode.</p>
<p>Part 3 - 6.4.4: […] it is not required that newly created or referenced
instances based on InstanceDeclarations have a ModellingRule, however, it
is allowed that they have any ModellingRule independent of the
ModellingRule of their InstanceDeclaration</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">modellingRulesOnInstances</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="limits">
<h3>Limits<a class="headerlink" href="#limits" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Limits for SecureChannels */</span>
<span class="n">UA_UInt16</span><span class="w"> </span><span class="n">maxSecureChannels</span><span class="p">;</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxSecurityTokenLifetime</span><span class="p">;</span><span class="w"> </span><span class="cm">/* in ms */</span>

<span class="cm">/* Limits for Sessions */</span>
<span class="n">UA_UInt16</span><span class="w"> </span><span class="n">maxSessions</span><span class="p">;</span>
<span class="n">UA_Double</span><span class="w"> </span><span class="n">maxSessionTimeout</span><span class="p">;</span><span class="w"> </span><span class="cm">/* in ms */</span>

<span class="cm">/* Operation limits */</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxNodesPerRead</span><span class="p">;</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxNodesPerWrite</span><span class="p">;</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxNodesPerMethodCall</span><span class="p">;</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxNodesPerBrowse</span><span class="p">;</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxNodesPerRegisterNodes</span><span class="p">;</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxNodesPerTranslateBrowsePathsToNodeIds</span><span class="p">;</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxNodesPerNodeManagement</span><span class="p">;</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxMonitoredItemsPerCall</span><span class="p">;</span>

<span class="cm">/* Limits for Requests */</span>
<span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxReferencesPerNode</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="async-operations">
<h3>Async Operations<a class="headerlink" href="#async-operations" title="Link to this heading">¶</a></h3>
<p>See the section for <a class="reference internal" href="#id8"><span class="std std-ref">async operations</span></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#if UA_MULTITHREADING &gt;= 100</span>
<span class="w">    </span><span class="n">UA_Double</span><span class="w"> </span><span class="n">asyncOperationTimeout</span><span class="p">;</span><span class="w"> </span><span class="cm">/* in ms, 0 =&gt; unlimited */</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">maxAsyncOperationQueueSize</span><span class="p">;</span><span class="w"> </span><span class="cm">/* 0 =&gt; unlimited */</span>
<span class="w">    </span><span class="cm">/* Notify workers when an async operation was enqueued */</span>
<span class="w">    </span><span class="n">UA_Server_AsyncOperationNotifyCallback</span><span class="w"> </span><span class="n">asyncOperationNotifyCallback</span><span class="p">;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</section>
<section id="discovery">
<h3>Discovery<a class="headerlink" href="#discovery" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef UA_ENABLE_DISCOVERY</span>
<span class="w">    </span><span class="cm">/* Timeout in seconds when to automatically remove a registered server from</span>
<span class="cm">     * the list, if it doesn&#39;t re-register within the given time frame. A value</span>
<span class="cm">     * of 0 disables automatic removal. Default is 60 Minutes (60*60). Must be</span>
<span class="cm">     * bigger than 10 seconds, because cleanup is only triggered approximately</span>
<span class="cm">     * every 10 seconds. The server will still be removed depending on the</span>
<span class="cm">     * state of the semaphore file. */</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">discoveryCleanupTimeout</span><span class="p">;</span>

<span class="cp"># ifdef UA_ENABLE_DISCOVERY_MULTICAST</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">mdnsEnabled</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_MdnsDiscoveryConfiguration</span><span class="w"> </span><span class="n">mdnsConfig</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_String</span><span class="w"> </span><span class="n">mdnsInterfaceIP</span><span class="p">;</span>
<span class="cp">#  if !defined(UA_HAS_GETIFADDR)</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">mdnsIpAddressListSize</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="o">*</span><span class="n">mdnsIpAddressList</span><span class="p">;</span>
<span class="cp">#  endif</span>
<span class="cp"># endif</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</section>
<section id="subscriptions">
<h3>Subscriptions<a class="headerlink" href="#subscriptions" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">subscriptionsEnabled</span><span class="p">;</span>
<span class="cp">#ifdef UA_ENABLE_SUBSCRIPTIONS</span>
<span class="w">    </span><span class="cm">/* Limits for Subscriptions */</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxSubscriptions</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxSubscriptionsPerSession</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_DurationRange</span><span class="w"> </span><span class="n">publishingIntervalLimits</span><span class="p">;</span><span class="w"> </span><span class="cm">/* in ms (must not be less than 5) */</span>
<span class="w">    </span><span class="n">UA_UInt32Range</span><span class="w"> </span><span class="n">lifeTimeCountLimits</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_UInt32Range</span><span class="w"> </span><span class="n">keepAliveCountLimits</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxNotificationsPerPublish</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">enableRetransmissionQueue</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxRetransmissionQueueSize</span><span class="p">;</span><span class="w"> </span><span class="cm">/* 0 -&gt; unlimited size */</span>
<span class="cp"># ifdef UA_ENABLE_SUBSCRIPTIONS_EVENTS</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxEventsPerNode</span><span class="p">;</span><span class="w"> </span><span class="cm">/* 0 -&gt; unlimited size */</span>
<span class="cp"># endif</span>

<span class="w">    </span><span class="cm">/* Limits for MonitoredItems */</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxMonitoredItems</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxMonitoredItemsPerSubscription</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_DurationRange</span><span class="w"> </span><span class="n">samplingIntervalLimits</span><span class="p">;</span><span class="w"> </span><span class="cm">/* in ms (must not be less than 5) */</span>
<span class="w">    </span><span class="n">UA_UInt32Range</span><span class="w"> </span><span class="n">queueSizeLimits</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Negotiated with the client */</span>

<span class="w">    </span><span class="cm">/* Limits for PublishRequests */</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxPublishReqPerSession</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Register MonitoredItem in Userland</span>
<span class="cm">     *</span>
<span class="cm">     * @param server Allows the access to the server object</span>
<span class="cm">     * @param sessionId The session id, represented as an node id</span>
<span class="cm">     * @param sessionContext An optional pointer to user-defined data for the</span>
<span class="cm">     *        specific data source</span>
<span class="cm">     * @param nodeid Id of the node in question</span>
<span class="cm">     * @param nodeidContext An optional pointer to user-defined data, associated</span>
<span class="cm">     *        with the node in the nodestore. Note that, if the node has already</span>
<span class="cm">     *        been removed, this value contains a NULL pointer.</span>
<span class="cm">     * @param attributeId Identifies which attribute (value, data type etc.) is</span>
<span class="cm">     *        monitored</span>
<span class="cm">     * @param removed Determines if the MonitoredItem was removed or created. */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">monitoredItemRegisterCallback</span><span class="p">)(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
<span class="w">                                          </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">sessionContext</span><span class="p">,</span>
<span class="w">                                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                                          </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span>
<span class="w">                                          </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">attibuteId</span><span class="p">,</span>
<span class="w">                                          </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">removed</span><span class="p">);</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</section>
<section id="pubsub">
<h3>PubSub<a class="headerlink" href="#pubsub" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">pubsubEnabled</span><span class="p">;</span>
<span class="cp">#ifdef UA_ENABLE_PUBSUB</span>
<span class="w">    </span><span class="n">UA_PubSubConfiguration</span><span class="w"> </span><span class="n">pubSubConfig</span><span class="p">;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</section>
<section id="historical-access">
<h3>Historical Access<a class="headerlink" href="#historical-access" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">historizingEnabled</span><span class="p">;</span>
<span class="cp">#ifdef UA_ENABLE_HISTORIZING</span>
<span class="w">    </span><span class="n">UA_HistoryDatabase</span><span class="w"> </span><span class="n">historyDatabase</span><span class="p">;</span>

<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">accessHistoryDataCapability</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w">  </span><span class="n">maxReturnDataValues</span><span class="p">;</span><span class="w"> </span><span class="cm">/* 0 -&gt; unlimited size */</span>

<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">accessHistoryEventsCapability</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w">  </span><span class="n">maxReturnEventValues</span><span class="p">;</span><span class="w"> </span><span class="cm">/* 0 -&gt; unlimited size */</span>

<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">insertDataCapability</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">insertEventCapability</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">insertAnnotationsCapability</span><span class="p">;</span>

<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">replaceDataCapability</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">replaceEventCapability</span><span class="p">;</span>

<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">updateDataCapability</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">updateEventCapability</span><span class="p">;</span>

<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">deleteRawCapability</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">deleteEventCapability</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">deleteAtTimeDataCapability</span><span class="p">;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</section>
<section id="reverse-connect">
<h3>Reverse Connect<a class="headerlink" href="#reverse-connect" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">reverseReconnectInterval</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Default is 15000 ms */</span>
</pre></div>
</div>
</section>
<section id="certificate-password-callback">
<h3>Certificate Password Callback<a class="headerlink" href="#certificate-password-callback" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef UA_ENABLE_ENCRYPTION</span>
<span class="w">    </span><span class="cm">/* If the private key is in PEM format and password protected, this callback</span>
<span class="cm">     * is called during initialization to get the password to decrypt the</span>
<span class="cm">     * private key. The memory containing the password is freed by the client</span>
<span class="cm">     * after use. The callback should be set early, other parts of the client</span>
<span class="cm">     * config setup may depend on it. */</span>
<span class="w">    </span><span class="n">UA_StatusCode</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">privateKeyPasswordCallback</span><span class="p">)(</span><span class="n">UA_ServerConfig</span><span class="w"> </span><span class="o">*</span><span class="n">sc</span><span class="p">,</span>
<span class="w">                                                </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="o">*</span><span class="n">password</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="kt">void</span>
<span class="nf">UA_ServerConfig_clean</span><span class="p">(</span><span class="n">UA_ServerConfig</span><span class="w"> </span><span class="o">*</span><span class="n">config</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="id3">
<span id="id4"></span><h2>Server Lifecycle<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Create a new server with a default configuration that adds plugins for</span>
<span class="cm"> * networking, security, logging and so on. See `server_config_default.h` for</span>
<span class="cm"> * more detailed options.</span>
<span class="cm"> *</span>
<span class="cm"> * The default configuration can be used as the starting point to adjust the</span>
<span class="cm"> * server configuration to individual needs. UA_Server_new is implemented in the</span>
<span class="cm"> * /plugins folder under the CC0 license. Furthermore the server confiugration</span>
<span class="cm"> * only uses the public server API.</span>
<span class="cm"> *</span>
<span class="cm"> * @return Returns the configured server or NULL if an error occurs. */</span>
<span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span>
<span class="nf">UA_Server_new</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/* Creates a new server. Moves the config into the server with a shallow copy.</span>
<span class="cm"> * The config content is cleared together with the server. */</span>
<span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span>
<span class="nf">UA_Server_newWithConfig</span><span class="p">(</span><span class="n">UA_ServerConfig</span><span class="w"> </span><span class="o">*</span><span class="n">config</span><span class="p">);</span>

<span class="cm">/* Delete the server. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_delete</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">);</span>

<span class="cm">/* Get the configuration. Always succeeds as this simplfy resolves a pointer.</span>
<span class="cm"> * Attention! Do not adjust the configuration while the server is running! */</span>
<span class="n">UA_ServerConfig</span><span class="w"> </span><span class="o">*</span>
<span class="nf">UA_Server_getConfig</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">);</span>

<span class="cm">/* Get the current server lifecycle state */</span>
<span class="n">UA_LifecycleState</span>
<span class="nf">UA_Server_getLifecycleState</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">);</span>

<span class="cm">/* Runs the server until interrupted. On Unix/Windows this registers an</span>
<span class="cm"> * interrupt for SIGINT (ctrl-c). The method only returns after having received</span>
<span class="cm"> * the interrupt. The logical sequence is as follows:</span>
<span class="cm"> *</span>
<span class="cm"> * - UA_Server_run_startup</span>
<span class="cm"> * - Loop until interrupt: UA_Server_run_iterate</span>
<span class="cm"> * - UA_Server_run_shutdown</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @return Returns a bad statuscode if an error occurred internally. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_run</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">volatile</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="o">*</span><span class="n">running</span><span class="p">);</span>

<span class="cm">/* Runs the server until interrupted. On Unix/Windows this registers an</span>
<span class="cm"> * interrupt for SIGINT (ctrl-c). The method only returns after having received</span>
<span class="cm"> * the interrupt or upon an error condition. The logical sequence is as follows:</span>
<span class="cm"> *</span>
<span class="cm"> * - Register the interrupt</span>
<span class="cm"> * - UA_Server_run_startup</span>
<span class="cm"> * - Loop until interrupt: UA_Server_run_iterate</span>
<span class="cm"> * - UA_Server_run_shutdown</span>
<span class="cm"> * - Deregister the interrupt</span>
<span class="cm"> *</span>
<span class="cm"> * Attention! This method is implemented individually for the different</span>
<span class="cm"> * platforms (POSIX/Win32/etc.). The default implementation is in</span>
<span class="cm"> * /plugins/ua_config_default.c under the CC0 license. Adjust as needed.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @return Returns a bad statuscode if an error occurred internally. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_runUntilInterrupt</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">);</span>

<span class="cm">/* The prologue part of UA_Server_run (no need to use if you call</span>
<span class="cm"> * UA_Server_run or UA_Server_runUntilInterrupt) */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_run_startup</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">);</span>

<span class="cm">/* Executes a single iteration of the server&#39;s main loop.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param waitInternal Should we wait for messages in the networklayer?</span>
<span class="cm"> *        Otherwise, the timouts for the networklayers are set to zero.</span>
<span class="cm"> *        The default max wait time is 200ms.</span>
<span class="cm"> * @return Returns how long we can wait until the next scheduled</span>
<span class="cm"> *         callback (in ms) */</span>
<span class="n">UA_UInt16</span>
<span class="nf">UA_Server_run_iterate</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">waitInternal</span><span class="p">);</span>

<span class="cm">/* The epilogue part of UA_Server_run (no need to use if you call</span>
<span class="cm"> * UA_Server_run or UA_Server_runUntilInterrupt) */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_run_shutdown</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="timed-callbacks">
<h2>Timed Callbacks<a class="headerlink" href="#timed-callbacks" title="Link to this heading">¶</a></h2>
<p>Add a callback to the server that is executed at a defined time.
The callback can also be registered with a cyclic interval.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Add a callback for execution at a specified time. If the indicated time lies</span>
<span class="cm"> * in the past, then the callback is executed at the next iteration of the</span>
<span class="cm"> * server&#39;s main loop.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param callback The callback that shall be added.</span>
<span class="cm"> * @param data Data that is forwarded to the callback.</span>
<span class="cm"> * @param date The timestamp for the execution time.</span>
<span class="cm"> * @param callbackId Set to the identifier of the repeated callback . This can</span>
<span class="cm"> *        be used to cancel the callback later on. If the pointer is null, the</span>
<span class="cm"> *        identifier is not set.</span>
<span class="cm"> * @return Upon success, ``UA_STATUSCODE_GOOD`` is returned. An error code</span>
<span class="cm"> *         otherwise. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_addTimedCallback</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ServerCallback</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span>
<span class="w">                           </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">UA_DateTime</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="o">*</span><span class="n">callbackId</span><span class="p">);</span>

<span class="cm">/* Add a callback for cyclic repetition to the server.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param callback The callback that shall be added.</span>
<span class="cm"> * @param data Data that is forwarded to the callback.</span>
<span class="cm"> * @param interval_ms The callback shall be repeatedly executed with the given</span>
<span class="cm"> *        interval (in ms). The interval must be positive. The first execution</span>
<span class="cm"> *        occurs at now() + interval at the latest.</span>
<span class="cm"> * @param callbackId Set to the identifier of the repeated callback . This can</span>
<span class="cm"> *        be used to cancel the callback later on. If the pointer is null, the</span>
<span class="cm"> *        identifier is not set.</span>
<span class="cm"> * @return Upon success, ``UA_STATUSCODE_GOOD`` is returned. An error code</span>
<span class="cm"> *         otherwise. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_addRepeatedCallback</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ServerCallback</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Double</span><span class="w"> </span><span class="n">interval_ms</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="o">*</span><span class="n">callbackId</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_changeRepeatedCallbackInterval</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="n">callbackId</span><span class="p">,</span>
<span class="w">                                         </span><span class="n">UA_Double</span><span class="w"> </span><span class="n">interval_ms</span><span class="p">);</span>

<span class="cm">/* Remove a repeated callback. Does nothing if the callback is not found.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param callbackId The id of the callback */</span>
<span class="kt">void</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_removeCallback</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="n">callbackId</span><span class="p">);</span>

<span class="cp">#define UA_Server_removeRepeatedCallback(server, callbackId) \</span>
<span class="cp">    UA_Server_removeCallback(server, callbackId);</span>
</pre></div>
</div>
</section>
<section id="session-handling">
<h2>Session Handling<a class="headerlink" href="#session-handling" title="Link to this heading">¶</a></h2>
<p>A new session is announced via the AccessControl plugin. The session
identifier is forwarded to the relevant callbacks back into userland. The
following methods enable an interaction with a particular session.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Manually close a session */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_closeSession</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">sessionId</span><span class="p">);</span>
</pre></div>
</div>
<p>Session attributes: Besides the user-definable session context pointer (set
by the AccessControl plugin when the Session is created), a session carries
attributes in a key-value list. Some attributes are present in every session
and shown in the list below. Additional attributes can be manually set as
meta-data.</p>
<p>Always present as session attributes are:</p>
<ul class="simple">
<li><p>0:localeIds [UA_String]: List of preferred languages (read-only)</p></li>
<li><p>0:clientDescription [UA_ApplicationDescription]: Client description (read-only)</p></li>
<li><p>0:sessionName [String] Client-defined name of the session (read-only)</p></li>
<li><p>0:clientUserId [String] User identifier used to activate the session (read-only)</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Returns a shallow copy of the attribute. Don&#39;t _clear or _delete the value</span>
<span class="cm"> * variant. Don&#39;t use the value once the Session could be already closed in the</span>
<span class="cm"> * background or the attribute of the session replaced. Hence don&#39;t use this in a</span>
<span class="cm"> * multi-threaded application. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_getSessionAttribute</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">outValue</span><span class="p">);</span>

<span class="cm">/* Return a deep copy of the attribute */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_getSessionAttributeCopy</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
<span class="w">                                  </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">outValue</span><span class="p">);</span>

<span class="cm">/* Returns NULL if the attribute is not defined or not a scalar or not of the</span>
<span class="cm"> * right datatype. Otherwise a shallow copy of the scalar value is created at</span>
<span class="cm"> * the target location of the void pointer. Hence don&#39;t use this in a</span>
<span class="cm"> * multi-threaded application. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_getSessionAttribute_scalar</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                     </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
<span class="w">                                     </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">                                     </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span><span class="n">type</span><span class="p">,</span>
<span class="w">                                     </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">outValue</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_setSessionAttribute</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_deleteSessionAttribute</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">sessionId</span><span class="p">,</span>
<span class="w">                                 </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="reading-and-writing-node-attributes">
<h2>Reading and Writing Node Attributes<a class="headerlink" href="#reading-and-writing-node-attributes" title="Link to this heading">¶</a></h2>
<p>The functions for reading and writing node attributes call the regular read
and write service in the background that are also used over the network.</p>
<p>The following attributes cannot be read, since the local “admin” user always
has full rights.</p>
<ul class="simple">
<li><p>UserWriteMask</p></li>
<li><p>UserAccessLevel</p></li>
<li><p>UserExecutable</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Read an attribute of a node. The specialized functions below provide a more</span>
<span class="cm"> * concise syntax.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param item ReadValueIds contain the NodeId of the target node, the id of the</span>
<span class="cm"> *             attribute to read and (optionally) an index range to read parts</span>
<span class="cm"> *             of an array only. See the section on NumericRange for the format</span>
<span class="cm"> *             used for array ranges.</span>
<span class="cm"> * @param timestamps Which timestamps to return for the attribute.</span>
<span class="cm"> * @return Returns a DataValue that contains either an error code, or a variant</span>
<span class="cm"> *         with the attribute value and the timestamps. */</span>
<span class="n">UA_DataValue</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_read</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ReadValueId</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<span class="w">               </span><span class="n">UA_TimestampsToReturn</span><span class="w"> </span><span class="n">timestamps</span><span class="p">);</span>

<span class="cm">/* Don&#39;t use this function. There are typed versions for every supported</span>
<span class="cm"> * attribute. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                 </span><span class="n">UA_AttributeId</span><span class="w"> </span><span class="n">attributeId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">v</span><span class="p">);</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readNodeId</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                     </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNodeId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_NODEID</span><span class="p">,</span><span class="w"> </span><span class="n">outNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readNodeClass</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                        </span><span class="n">UA_NodeClass</span><span class="w"> </span><span class="o">*</span><span class="n">outNodeClass</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_NODECLASS</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outNodeClass</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readBrowseName</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                         </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="o">*</span><span class="n">outBrowseName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_BROWSENAME</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outBrowseName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readDisplayName</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_LocalizedText</span><span class="w"> </span><span class="o">*</span><span class="n">outDisplayName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_DISPLAYNAME</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outDisplayName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readDescription</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_LocalizedText</span><span class="w"> </span><span class="o">*</span><span class="n">outDescription</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_DESCRIPTION</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outDescription</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readWriteMask</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                        </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="o">*</span><span class="n">outWriteMask</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_WRITEMASK</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outWriteMask</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readIsAbstract</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                         </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="o">*</span><span class="n">outIsAbstract</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_ISABSTRACT</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outIsAbstract</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readSymmetric</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                        </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="o">*</span><span class="n">outSymmetric</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_SYMMETRIC</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outSymmetric</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readInverseName</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_LocalizedText</span><span class="w"> </span><span class="o">*</span><span class="n">outInverseName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_INVERSENAME</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outInverseName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readContainsNoLoops</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="o">*</span><span class="n">outContainsNoLoops</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_CONTAINSNOLOOPS</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outContainsNoLoops</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readEventNotifier</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                            </span><span class="n">UA_Byte</span><span class="w"> </span><span class="o">*</span><span class="n">outEventNotifier</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_EVENTNOTIFIER</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outEventNotifier</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readValue</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                    </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">outValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">outValue</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readDataType</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                       </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outDataType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_DATATYPE</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outDataType</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readValueRank</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                        </span><span class="n">UA_Int32</span><span class="w"> </span><span class="o">*</span><span class="n">outValueRank</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_VALUERANK</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outValueRank</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Returns a variant with an int32 array */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readArrayDimensions</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">outArrayDimensions</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_ARRAYDIMENSIONS</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outArrayDimensions</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readAccessLevel</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_Byte</span><span class="w"> </span><span class="o">*</span><span class="n">outAccessLevel</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_ACCESSLEVEL</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outAccessLevel</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readAccessLevelEx</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                            </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="o">*</span><span class="n">outAccessLevelEx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_ACCESSLEVELEX</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outAccessLevelEx</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readMinimumSamplingInterval</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                                      </span><span class="n">UA_Double</span><span class="w"> </span><span class="o">*</span><span class="n">outMinimumSamplingInterval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                            </span><span class="n">UA_ATTRIBUTEID_MINIMUMSAMPLINGINTERVAL</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outMinimumSamplingInterval</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readHistorizing</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="o">*</span><span class="n">outHistorizing</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_HISTORIZING</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outHistorizing</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_readExecutable</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                         </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="o">*</span><span class="n">outExecutable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_read</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_EXECUTABLE</span><span class="p">,</span>
<span class="w">                            </span><span class="n">outExecutable</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following node attributes cannot be changed once a node has been created:</p>
<ul class="simple">
<li><p>NodeClass</p></li>
<li><p>NodeId</p></li>
<li><p>Symmetric</p></li>
<li><p>ContainsNoLoops</p></li>
</ul>
<p>The following attributes cannot be written from the server, as they are
specific to the different users and set by the access control callback:</p>
<ul class="simple">
<li><p>UserWriteMask</p></li>
<li><p>UserAccessLevel</p></li>
<li><p>UserExecutable</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Overwrite an attribute of a node. The specialized functions below provide a</span>
<span class="cm"> * more concise syntax.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object.</span>
<span class="cm"> * @param value WriteValues contain the NodeId of the target node, the id of the</span>
<span class="cm"> *              attribute to overwritten, the actual value and (optionally) an</span>
<span class="cm"> *              index range to replace parts of an array only. of an array only.</span>
<span class="cm"> *              See the section on NumericRange for the format used for array</span>
<span class="cm"> *              ranges.</span>
<span class="cm"> * @return Returns a status code. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_write</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_WriteValue</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">);</span>

<span class="cm">/* Don&#39;t use this function. There are typed versions with no additional</span>
<span class="cm"> * overhead. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="n">UA_AttributeId</span><span class="w"> </span><span class="n">attributeId</span><span class="p">,</span>
<span class="w">                  </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span><span class="n">attr_type</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">);</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeBrowseName</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_BROWSENAME</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_QUALIFIEDNAME</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">browseName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeDisplayName</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">UA_LocalizedText</span><span class="w"> </span><span class="n">displayName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_DISPLAYNAME</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_LOCALIZEDTEXT</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">displayName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeDescription</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">UA_LocalizedText</span><span class="w"> </span><span class="n">description</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_DESCRIPTION</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_LOCALIZEDTEXT</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">description</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeWriteMask</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">writeMask</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_WRITEMASK</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_UINT32</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">writeMask</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeIsAbstract</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">isAbstract</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_ISABSTRACT</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BOOLEAN</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">isAbstract</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeInverseName</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">UA_LocalizedText</span><span class="w"> </span><span class="n">inverseName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_INVERSENAME</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_LOCALIZEDTEXT</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">inverseName</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeEventNotifier</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                             </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Byte</span><span class="w"> </span><span class="n">eventNotifier</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_EVENTNOTIFIER</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BYTE</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">eventNotifier</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeValue</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_VALUE</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_VARIANT</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Writes an UA_DataValue to a variable/variableType node. In contrast to</span>
<span class="cm"> * UA_Server_writeValue, this functions can also write SourceTimestamp,</span>
<span class="cm"> * ServerTimestamp and StatusCode. */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeDataValue</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataValue</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_VALUE</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DATAVALUE</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeDataType</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">dataType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_DATATYPE</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_NODEID</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dataType</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeValueRank</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Int32</span><span class="w"> </span><span class="n">valueRank</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_VALUERANK</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_INT32</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">valueRank</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeArrayDimensions</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="n">arrayDimensions</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_ARRAYDIMENSIONS</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_VARIANT</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">arrayDimensions</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeAccessLevel</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Byte</span><span class="w"> </span><span class="n">accessLevel</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_ACCESSLEVEL</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BYTE</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">accessLevel</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeAccessLevelEx</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                             </span><span class="k">const</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">accessLevelEx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_ACCESSLEVELEX</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_UINT32</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">accessLevelEx</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeMinimumSamplingInterval</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                                       </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Double</span><span class="w"> </span><span class="n">miniumSamplingInterval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                             </span><span class="n">UA_ATTRIBUTEID_MINIMUMSAMPLINGINTERVAL</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DOUBLE</span><span class="p">],</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">miniumSamplingInterval</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeHistorizing</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">historizing</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                             </span><span class="n">UA_ATTRIBUTEID_HISTORIZING</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BOOLEAN</span><span class="p">],</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">historizing</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_writeExecutable</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">executable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_write</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ATTRIBUTEID_EXECUTABLE</span><span class="p">,</span>
<span class="w">                             </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BOOLEAN</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">executable</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="browsing">
<h2>Browsing<a class="headerlink" href="#browsing" title="Link to this heading">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Browse the references of a particular node. See the definition of</span>
<span class="cm"> * BrowseDescription structure for details. */</span>
<span class="n">UA_BrowseResult</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_browse</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxReferences</span><span class="p">,</span>
<span class="w">                 </span><span class="k">const</span><span class="w"> </span><span class="n">UA_BrowseDescription</span><span class="w"> </span><span class="o">*</span><span class="n">bd</span><span class="p">);</span>

<span class="n">UA_BrowseResult</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_browseNext</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">releaseContinuationPoint</span><span class="p">,</span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="o">*</span><span class="n">continuationPoint</span><span class="p">);</span>

<span class="cm">/* Non-standard version of the Browse service that recurses into child nodes.</span>
<span class="cm"> *</span>
<span class="cm"> * Possible loops (that can occur for non-hierarchical references) are handled</span>
<span class="cm"> * internally. Every node is added at most once to the results array.</span>
<span class="cm"> *</span>
<span class="cm"> * Nodes are only added if they match the NodeClassMask in the</span>
<span class="cm"> * BrowseDescription. However, child nodes are still recursed into if the</span>
<span class="cm"> * NodeClass does not match. So it is possible, for example, to get all</span>
<span class="cm"> * VariableNodes below a certain ObjectNode, with additional objects in the</span>
<span class="cm"> * hierarchy below. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_browseRecursive</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_BrowseDescription</span><span class="w"> </span><span class="o">*</span><span class="n">bd</span><span class="p">,</span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">resultsSize</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ExpandedNodeId</span><span class="w"> </span><span class="o">**</span><span class="n">results</span><span class="p">);</span>

<span class="n">UA_BrowsePathResult</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_translateBrowsePathToNodeIds</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                       </span><span class="k">const</span><span class="w"> </span><span class="n">UA_BrowsePath</span><span class="w"> </span><span class="o">*</span><span class="n">browsePath</span><span class="p">);</span>

<span class="cm">/* A simplified TranslateBrowsePathsToNodeIds based on the</span>
<span class="cm"> * SimpleAttributeOperand type (Part 4, 7.4.4.5).</span>
<span class="cm"> *</span>
<span class="cm"> * This specifies a relative path using a list of BrowseNames instead of the</span>
<span class="cm"> * RelativePath structure. The list of BrowseNames is equivalent to a</span>
<span class="cm"> * RelativePath that specifies forward references which are subtypes of the</span>
<span class="cm"> * HierarchicalReferences ReferenceType. All Nodes followed by the browsePath</span>
<span class="cm"> * shall be of the NodeClass Object or Variable. */</span>
<span class="n">UA_BrowsePathResult</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_browseSimplifiedBrowsePath</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">origin</span><span class="p">,</span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">browsePathSize</span><span class="p">,</span>
<span class="w">                                     </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="o">*</span><span class="n">browsePath</span><span class="p">);</span>

<span class="cp">#ifndef HAVE_NODEITER_CALLBACK</span>
<span class="cp">#define HAVE_NODEITER_CALLBACK</span>
<span class="cm">/* Iterate over all nodes referenced by parentNodeId by calling the callback</span>
<span class="cm"> * function for each child node (in ifdef because GCC/CLANG handle include order</span>
<span class="cm"> * differently) */</span>
<span class="k">typedef</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="p">(</span><span class="o">*</span><span class="n">UA_NodeIteratorCallback</span><span class="p">)(</span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">childId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">isInverse</span><span class="p">,</span>
<span class="w">                           </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_forEachChildNodeCall</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                               </span><span class="n">UA_NodeIteratorCallback</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_DISCOVERY</span>
</pre></div>
</div>
</section>
<section id="id5">
<h2>Discovery<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h2>
<section id="registering-at-a-discovery-server">
<h3>Registering at a Discovery Server<a class="headerlink" href="#registering-at-a-discovery-server" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Register the given server instance at the discovery server. This should be</span>
<span class="cm"> * called periodically, for example every 10 minutes, depending on the</span>
<span class="cm"> * configuration of the discovery server. You should also call</span>
<span class="cm"> * _unregisterDiscovery when the server shuts down.</span>
<span class="cm"> *</span>
<span class="cm"> * The supplied client configuration is used to create a new client to connect</span>
<span class="cm"> * to the discovery server. The client configuration is moved over to the server</span>
<span class="cm"> * and eventually cleaned up internally. The structure pointed at by `cc` is</span>
<span class="cm"> * zeroed to avoid accessing outdated information.</span>
<span class="cm"> *</span>
<span class="cm"> * The eventloop and logging plugins in the client configuration are replaced by</span>
<span class="cm"> * those configured in the server. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_registerDiscovery</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">cc</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_String</span><span class="w"> </span><span class="n">discoveryServerUrl</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_String</span><span class="w"> </span><span class="n">semaphoreFilePath</span><span class="p">);</span>

<span class="cm">/* Deregister the given server instance from the discovery server.</span>
<span class="cm"> * This should be called when the server is shutting down. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_deregisterDiscovery</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">cc</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_String</span><span class="w"> </span><span class="n">discoveryServerUrl</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="operating-a-discovery-server">
<h3>Operating a Discovery Server<a class="headerlink" href="#operating-a-discovery-server" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Callback for RegisterServer. Data is passed from the register call */</span>
<span class="k">typedef</span><span class="w"> </span><span class="kt">void</span>
<span class="p">(</span><span class="o">*</span><span class="n">UA_Server_registerServerCallback</span><span class="p">)(</span><span class="k">const</span><span class="w"> </span><span class="n">UA_RegisteredServer</span><span class="w"> </span><span class="o">*</span><span class="n">registeredServer</span><span class="p">,</span>
<span class="w">                                    </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>

<span class="cm">/* Set the callback which is called if another server registeres or unregisters</span>
<span class="cm"> * with this instance. This callback is called every time the server gets a</span>
<span class="cm"> * register call. This especially means that for every periodic server register</span>
<span class="cm"> * the callback will be called.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server</span>
<span class="cm"> * @param cb the callback</span>
<span class="cm"> * @param data data passed to the callback</span>
<span class="cm"> * @return ``UA_STATUSCODE_SUCCESS`` on success */</span>
<span class="kt">void</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_setRegisterServerCallback</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">UA_Server_registerServerCallback</span><span class="w"> </span><span class="n">cb</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_DISCOVERY_MULTICAST</span>

<span class="cm">/* Callback for server detected through mDNS. Data is passed from the register</span>
<span class="cm"> * call</span>
<span class="cm"> *</span>
<span class="cm"> * @param isServerAnnounce indicates if the server has just been detected. If</span>
<span class="cm"> *        set to false, this means the server is shutting down.</span>
<span class="cm"> * @param isTxtReceived indicates if we already received the corresponding TXT</span>
<span class="cm"> *        record with the path and caps data */</span>
<span class="k">typedef</span><span class="w"> </span><span class="kt">void</span>
<span class="p">(</span><span class="o">*</span><span class="n">UA_Server_serverOnNetworkCallback</span><span class="p">)(</span><span class="k">const</span><span class="w"> </span><span class="n">UA_ServerOnNetwork</span><span class="w"> </span><span class="o">*</span><span class="n">serverOnNetwork</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">isServerAnnounce</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">isTxtReceived</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>

<span class="cm">/* Set the callback which is called if another server is found through mDNS or</span>
<span class="cm"> * deleted. It will be called for any mDNS message from the remote server, thus</span>
<span class="cm"> * it may be called multiple times for the same instance. Also the SRV and TXT</span>
<span class="cm"> * records may arrive later, therefore for the first call the server</span>
<span class="cm"> * capabilities may not be set yet. If called multiple times, previous data will</span>
<span class="cm"> * be overwritten.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server</span>
<span class="cm"> * @param cb the callback</span>
<span class="cm"> * @param data data passed to the callback</span>
<span class="cm"> * @return ``UA_STATUSCODE_SUCCESS`` on success */</span>
<span class="kt">void</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Server_setServerOnNetworkCallback</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">UA_Server_serverOnNetworkCallback</span><span class="w"> </span><span class="n">cb</span><span class="p">,</span>
<span class="w">                                     </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* UA_ENABLE_DISCOVERY_MULTICAST */</span>

<span class="cp">#endif </span><span class="cm">/* UA_ENABLE_DISCOVERY */</span>
</pre></div>
</div>
</section>
</section>
<section id="information-model-callbacks">
<h2>Information Model Callbacks<a class="headerlink" href="#information-model-callbacks" title="Link to this heading">¶</a></h2>
<p>There are three places where a callback from an information model to
user-defined code can happen.</p>
<ul class="simple">
<li><p>Custom node constructors and destructors</p></li>
<li><p>Linking VariableNodes with an external data source</p></li>
<li><p>MethodNode callbacks</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span>
<span class="nf">UA_Server_setAdminSessionContext</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                 </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">context</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_setNodeTypeLifecycle</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                               </span><span class="n">UA_NodeTypeLifecycle</span><span class="w"> </span><span class="n">lifecycle</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_getNodeContext</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                         </span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="n">nodeContext</span><span class="p">);</span>

<span class="cm">/* Careful! The user has to ensure that the destructor callbacks still work. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_setNodeContext</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                         </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">);</span>
</pre></div>
</div>
<section id="data-source-callback">
<span id="datasource"></span><h3>Data Source Callback<a class="headerlink" href="#data-source-callback" title="Link to this heading">¶</a></h3>
<p>The server has a unique way of dealing with the content of variables. Instead
of storing a variant attached to the variable node, the node can point to a
function with a local data provider. Whenever the value attribute is read,
the function will be called and asked to provide a UA_DataValue return value
that contains the value content and additional timestamps.</p>
<p>It is expected that the read callback is implemented. The write callback can
be set to a null-pointer.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_setVariableNode_dataSource</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                                     </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataSource</span><span class="w"> </span><span class="n">dataSource</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_setVariableNode_valueCallback</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ValueCallback</span><span class="w"> </span><span class="n">callback</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_setVariableNode_valueBackend</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                       </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                                       </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ValueBackend</span><span class="w"> </span><span class="n">valueBackend</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="local-monitoreditems">
<span id="id6"></span><h3>Local MonitoredItems<a class="headerlink" href="#local-monitoreditems" title="Link to this heading">¶</a></h3>
<p>MonitoredItems are used with the Subscription mechanism of OPC UA to
transported notifications for data changes and events. MonitoredItems can
also be registered locally. Notifications are then forwarded to a
user-defined callback instead of a remote client.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef UA_ENABLE_SUBSCRIPTIONS</span>

<span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">UA_Server_DataChangeNotificationCallback</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">monitoredItemId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">monitoredItemContext</span><span class="p">,</span>
<span class="w">     </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">nodeId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">attributeId</span><span class="p">,</span>
<span class="w">     </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataValue</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">);</span>

<span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">UA_Server_EventNotificationCallback</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">monId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">monContext</span><span class="p">,</span>
<span class="w">     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nEventFields</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">eventFields</span><span class="p">);</span>

<span class="cm">/* Create a local MonitoredItem with a sampling interval that detects data</span>
<span class="cm"> * changes.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server executing the MonitoredItem</span>
<span class="cm"> * @timestampsToReturn Shall timestamps be added to the value for the callback?</span>
<span class="cm"> * @item The parameters of the new MonitoredItem. Note that the attribute of the</span>
<span class="cm"> *       ReadValueId (the node that is monitored) can not be</span>
<span class="cm"> *       ``UA_ATTRIBUTEID_EVENTNOTIFIER``. A different callback type needs to be</span>
<span class="cm"> *       registered for event notifications.</span>
<span class="cm"> * @monitoredItemContext A pointer that is forwarded with the callback</span>
<span class="cm"> * @callback The callback that is executed on detected data changes</span>
<span class="cm"> *</span>
<span class="cm"> * @return Returns a description of the created MonitoredItem. The structure</span>
<span class="cm"> * also contains a StatusCode (in case of an error) and the identifier of the</span>
<span class="cm"> * new MonitoredItem. */</span>
<span class="n">UA_MonitoredItemCreateResult</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_createDataChangeMonitoredItem</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">          </span><span class="n">UA_TimestampsToReturn</span><span class="w"> </span><span class="n">timestampsToReturn</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_MonitoredItemCreateRequest</span><span class="w"> </span><span class="n">item</span><span class="p">,</span>
<span class="w">          </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">monitoredItemContext</span><span class="p">,</span>
<span class="w">          </span><span class="n">UA_Server_DataChangeNotificationCallback</span><span class="w"> </span><span class="n">callback</span><span class="p">);</span>

<span class="cm">/* UA_MonitoredItemCreateResult */</span>
<span class="cm">/* UA_Server_createEventMonitoredItem(UA_Server *server, */</span>
<span class="cm">/*           UA_TimestampsToReturn timestampsToReturn, */</span>
<span class="cm">/*           const UA_MonitoredItemCreateRequest item, void *context, */</span>
<span class="cm">/*           UA_Server_EventNotificationCallback callback); */</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_deleteMonitoredItem</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">monitoredItemId</span><span class="p">);</span>

<span class="cp">#endif</span>
</pre></div>
</div>
</section>
<section id="method-callbacks">
<h3>Method Callbacks<a class="headerlink" href="#method-callbacks" title="Link to this heading">¶</a></h3>
<p>Method callbacks are set to <cite>NULL</cite> (not executable) when a method node is
added over the network. In theory, it is possible to add a callback via
<code class="docutils literal notranslate"><span class="pre">UA_Server_setMethodNode_callback</span></code> within the global constructor when
adding methods over the network is really wanted. See the Section
<a class="reference internal" href="#object-interaction"><span class="std std-ref">Interacting with Objects</span></a> for calling methods on an object.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef UA_ENABLE_METHODCALLS</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_setMethodNodeCallback</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">methodNodeId</span><span class="p">,</span>
<span class="w">                                </span><span class="n">UA_MethodCallback</span><span class="w"> </span><span class="n">methodCallback</span><span class="p">);</span>

<span class="cm">/* Backwards compatibility definition */</span>
<span class="cp">#define UA_Server_setMethodNode_callback(server, methodNodeId, methodCallback) \</span>
<span class="cp">    UA_Server_setMethodNodeCallback(server, methodNodeId, methodCallback)</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_getMethodNodeCallback</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">methodNodeId</span><span class="p">,</span>
<span class="w">                                </span><span class="n">UA_MethodCallback</span><span class="w"> </span><span class="o">*</span><span class="n">outMethodCallback</span><span class="p">);</span>

<span class="n">UA_CallMethodResult</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_call</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_CallMethodRequest</span><span class="w"> </span><span class="o">*</span><span class="n">request</span><span class="p">);</span>
<span class="cp">#endif</span>
</pre></div>
</div>
</section>
</section>
<section id="interacting-with-objects">
<span id="object-interaction"></span><h2>Interacting with Objects<a class="headerlink" href="#interacting-with-objects" title="Link to this heading">¶</a></h2>
<p>Objects in the information model are represented as ObjectNodes. Some
convenience functions are provided to simplify the interaction with objects.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Write an object property. The property is represented as a VariableNode with</span>
<span class="cm"> * a ``HasProperty`` reference from the ObjectNode. The VariableNode is</span>
<span class="cm"> * identified by its BrowseName. Writing the property sets the value attribute</span>
<span class="cm"> * of the VariableNode.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param objectId The identifier of the object (node)</span>
<span class="cm"> * @param propertyName The name of the property</span>
<span class="cm"> * @param value The value to be set for the event attribute</span>
<span class="cm"> * @return The StatusCode for setting the event attribute */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_writeObjectProperty</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">objectId</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">propertyName</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>

<span class="cm">/* Directly point to the scalar value instead of a variant */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_writeObjectProperty_scalar</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">objectId</span><span class="p">,</span>
<span class="w">                                     </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">propertyName</span><span class="p">,</span>
<span class="w">                                     </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span><span class="n">type</span><span class="p">);</span>

<span class="cm">/* Read an object property.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param objectId The identifier of the object (node)</span>
<span class="cm"> * @param propertyName The name of the property</span>
<span class="cm"> * @param value Contains the property value after reading. Must not be NULL.</span>
<span class="cm"> * @return The StatusCode for setting the event attribute */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_readObjectProperty</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">objectId</span><span class="p">,</span>
<span class="w">                             </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">propertyName</span><span class="p">,</span>
<span class="w">                             </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="node-addition-and-deletion">
<span id="addnodes"></span><h2>Node Addition and Deletion<a class="headerlink" href="#node-addition-and-deletion" title="Link to this heading">¶</a></h2>
<p>When creating dynamic node instances at runtime, chances are that you will
not care about the specific NodeId of the new node, as long as you can
reference it later. When passing numeric NodeIds with a numeric identifier 0,
the stack evaluates this as “select a random unassigned numeric NodeId in
that namespace”. To find out which NodeId was actually assigned to the new
node, you may pass a pointer <cite>outNewNodeId</cite>, which will (after a successful
node insertion) contain the nodeId of the new node. You may also pass a
<code class="docutils literal notranslate"><span class="pre">NULL</span></code> pointer if this result is not needed.</p>
<p>See the Section <a class="reference internal" href="plugin_nodestore.html#node-lifecycle"><span class="std std-ref">Node Lifecycle: Constructors, Destructors and Node Contexts</span></a> on constructors and on attaching
user-defined data to nodes.</p>
<p>The Section <a class="reference internal" href="util.html#default-node-attributes"><span class="std std-ref">Default Node Attributes</span></a> contains useful starting points
for defining node attributes. Forgetting to set the ValueRank or the
AccessLevel leads to errors that can be hard to track down for new users. The
default attributes have a high likelihood to “do the right thing”.</p>
<p>The methods for node addition and deletion take mostly const arguments that
are not modified. When creating a node, a deep copy of the node identifier,
node attributes, etc. is created. Therefore, it is possible to call for
example <code class="docutils literal notranslate"><span class="pre">UA_Server_addVariablenode</span></code> with a value attribute (a
<a class="reference internal" href="types.html#variant"><span class="std std-ref">Variant</span></a>) pointing to a memory location on the stack. If you need
changes to a variable value to manifest at a specific memory location, please
use a <a class="reference internal" href="#datasource"><span class="std std-ref">Data Source Callback</span></a> or a <a class="reference internal" href="plugin_nodestore.html#value-callback"><span class="std std-ref">Value Callback</span></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Don&#39;t use this function. There are typed versions as inline functions. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeClass</span><span class="w"> </span><span class="n">nodeClass</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">typeDefinition</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeAttributes</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span><span class="n">attributeType</span><span class="p">,</span>
<span class="w">                    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">);</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_addVariableNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">typeDefinition</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_VariableAttributes</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span>
<span class="w">                          </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODECLASS_VARIABLE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">typeDefinition</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_VARIABLEATTRIBUTES</span><span class="p">],</span>
<span class="w">                               </span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_addVariableTypeNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">typeDefinition</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_VariableTypeAttributes</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODECLASS_VARIABLETYPE</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                               </span><span class="n">browseName</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">typeDefinition</span><span class="p">,</span>
<span class="w">                               </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_VARIABLETYPEATTRIBUTES</span><span class="p">],</span>
<span class="w">                               </span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_addObjectNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">typeDefinition</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ObjectAttributes</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span>
<span class="w">                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODECLASS_OBJECT</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">typeDefinition</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_OBJECTATTRIBUTES</span><span class="p">],</span>
<span class="w">                               </span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_addObjectTypeNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ObjectTypeAttributes</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span>
<span class="w">                            </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODECLASS_OBJECTTYPE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_OBJECTTYPEATTRIBUTES</span><span class="p">],</span>
<span class="w">                               </span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_addViewNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                      </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                      </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                      </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                      </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ViewAttributes</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span>
<span class="w">                      </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODECLASS_VIEW</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_VIEWATTRIBUTES</span><span class="p">],</span>
<span class="w">                               </span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_addReferenceTypeNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ReferenceTypeAttributes</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span>
<span class="w">                               </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODECLASS_REFERENCETYPE</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                               </span><span class="n">browseName</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_NODEID_NULL</span><span class="p">,</span>
<span class="w">                               </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_REFERENCETYPEATTRIBUTES</span><span class="p">],</span>
<span class="w">                               </span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_addDataTypeNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataTypeAttributes</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span>
<span class="w">                          </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Server_addNode</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODECLASS_DATATYPE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">parentNodeId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">referenceTypeId</span><span class="p">,</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeAttributes</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DATATYPEATTRIBUTES</span><span class="p">],</span>
<span class="w">                               </span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_addDataSourceVariableNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">typeDefinition</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_VariableAttributes</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataSource</span><span class="w"> </span><span class="n">dataSource</span><span class="p">,</span>
<span class="w">                                    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">);</span>

<span class="cm">/* VariableNodes that are &quot;dynamic&quot; (default for user-created variables) receive</span>
<span class="cm"> * and store a SourceTimestamp. For non-dynamic VariableNodes the current time</span>
<span class="cm"> * is used for the SourceTimestamp. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_setVariableNodeDynamic</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                                 </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">isDynamic</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_METHODCALLS</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_addMethodNodeEx</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_MethodAttributes</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">UA_MethodCallback</span><span class="w"> </span><span class="n">method</span><span class="p">,</span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">inputArgumentsSize</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Argument</span><span class="w"> </span><span class="o">*</span><span class="n">inputArguments</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">inputArgumentsRequestedNewNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">inputArgumentsOutNewNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">outputArgumentsSize</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Argument</span><span class="w"> </span><span class="o">*</span><span class="n">outputArguments</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">outputArgumentsRequestedNewNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outputArgumentsOutNewNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">);</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Server_addMethodNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_MethodAttributes</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span>
<span class="w">                        </span><span class="n">UA_MethodCallback</span><span class="w"> </span><span class="n">method</span><span class="p">,</span>
<span class="w">                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">inputArgumentsSize</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Argument</span><span class="w"> </span><span class="o">*</span><span class="n">inputArguments</span><span class="p">,</span>
<span class="w">                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">outputArgumentsSize</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Argument</span><span class="w"> </span><span class="o">*</span><span class="n">outputArguments</span><span class="p">,</span>
<span class="w">                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">UA_Server_addMethodNodeEx</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span><span class="w">  </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">referenceTypeId</span><span class="p">,</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">inputArgumentsSize</span><span class="p">,</span><span class="w"> </span><span class="n">inputArguments</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">outputArgumentsSize</span><span class="p">,</span><span class="w"> </span><span class="n">outputArguments</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">UA_NODEID_NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">outNewNodeId</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#endif</span>
</pre></div>
</div>
<p>The method pair UA_Server_addNode_begin and _finish splits the AddNodes
service in two parts. This is useful if the node shall be modified before
finish the instantiation. For example to add children with specific NodeIds.
Otherwise, mandatory children (e.g. of an ObjectType) are added with
pseudo-random unique NodeIds. Existing children are detected during the
_finish part via their matching BrowseName.</p>
<dl class="simple">
<dt>The _begin method:</dt><dd><ul class="simple">
<li><p>prepares the node and adds it to the nodestore</p></li>
<li><p>copies some unassigned attributes from the TypeDefinition node internally</p></li>
<li><p>adds the references to the parent (and the TypeDefinition if applicable)</p></li>
<li><p>performs type-checking of variables.</p></li>
</ul>
</dd>
</dl>
<p>You can add an object node without a parent if you set the parentNodeId and
referenceTypeId to UA_NODE_ID_NULL. Then you need to add the parent reference
and hasTypeDef reference yourself before calling the _finish method.
Not that this is only allowed for object nodes.</p>
<dl class="simple">
<dt>The _finish method:</dt><dd><ul class="simple">
<li><p>copies mandatory children</p></li>
<li><p>calls the node constructor(s) at the end</p></li>
<li><p>may remove the node if it encounters an error.</p></li>
</ul>
</dd>
</dl>
<p>The special UA_Server_addMethodNode_finish method needs to be used for method
nodes, since there you need to explicitly specifiy the input and output
arguments which are added in the finish step (if not yet already there)</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* The ``attr`` argument must have a type according to the NodeClass.</span>
<span class="cm"> * ``VariableAttributes`` for variables, ``ObjectAttributes`` for objects, and</span>
<span class="cm"> * so on. Missing attributes are taken from the TypeDefinition node if</span>
<span class="cm"> * applicable. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_addNode_begin</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeClass</span><span class="w"> </span><span class="n">nodeClass</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">requestedNewNodeId</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">parentNodeId</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">browseName</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">typeDefinition</span><span class="p">,</span>
<span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span><span class="n">attributeType</span><span class="p">,</span>
<span class="w">                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNewNodeId</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_addNode_finish</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">);</span>

<span class="cp">#ifdef UA_ENABLE_METHODCALLS</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_addMethodNode_finish</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                         </span><span class="n">UA_MethodCallback</span><span class="w"> </span><span class="n">method</span><span class="p">,</span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">inputArgumentsSize</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Argument</span><span class="w"> </span><span class="o">*</span><span class="n">inputArguments</span><span class="p">,</span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">outputArgumentsSize</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Argument</span><span class="w"> </span><span class="o">*</span><span class="n">outputArguments</span><span class="p">);</span>

<span class="cp">#endif</span>

<span class="cm">/* Deletes a node and optionally all references leading to the node. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_deleteNode</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">nodeId</span><span class="p">,</span>
<span class="w">                     </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">deleteReferences</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="reference-management">
<h2>Reference Management<a class="headerlink" href="#reference-management" title="Link to this heading">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_addReference</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">sourceId</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">refTypeId</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ExpandedNodeId</span><span class="w"> </span><span class="n">targetId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">isForward</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_deleteReference</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">sourceNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">referenceTypeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">isForward</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ExpandedNodeId</span><span class="w"> </span><span class="n">targetNodeId</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">deleteBidirectional</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="events">
<span id="id7"></span><h2>Events<a class="headerlink" href="#events" title="Link to this heading">¶</a></h2>
<p>The method <code class="docutils literal notranslate"><span class="pre">UA_Server_createEvent</span></code> creates an event and represents it as
node. The node receives a unique <cite>EventId</cite> which is automatically added to
the node. The method returns a <cite>NodeId</cite> to the object node which represents
the event through <code class="docutils literal notranslate"><span class="pre">outNodeId</span></code>. The <cite>NodeId</cite> can be used to set the
attributes of the event. The generated <cite>NodeId</cite> is always numeric.
<code class="docutils literal notranslate"><span class="pre">outNodeId</span></code> cannot be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
<p>Note: In order to see an event in UAExpert, the field <cite>Time</cite> must be given a
value!</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">UA_Server_triggerEvent</span></code> “triggers” an event by adding it to all
monitored items of the specified origin node and those of all its parents.
Any filters specified by the monitored items are automatically applied. Using
this method deletes the node generated by <code class="docutils literal notranslate"><span class="pre">UA_Server_createEvent</span></code>. The
<cite>EventId</cite> for the new event is generated automatically and is returned
through <code class="docutils literal notranslate"><span class="pre">outEventId</span></code>. <code class="docutils literal notranslate"><span class="pre">NULL</span></code> can be passed if the <cite>EventId</cite> is not
needed. <code class="docutils literal notranslate"><span class="pre">deleteEventNode</span></code> specifies whether the node representation of the
event should be deleted after invoking the method. This can be useful if
events with the similar attributes are triggered frequently. <code class="docutils literal notranslate"><span class="pre">UA_TRUE</span></code>
would cause the node to be deleted.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef UA_ENABLE_SUBSCRIPTIONS_EVENTS</span>

<span class="cm">/* Creates a node representation of an event</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param eventType The type of the event for which a node should be created</span>
<span class="cm"> * @param outNodeId The NodeId of the newly created node for the event</span>
<span class="cm"> * @return The StatusCode of the UA_Server_createEvent method */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_createEvent</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">eventType</span><span class="p">,</span>
<span class="w">                      </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outNodeId</span><span class="p">);</span>

<span class="cm">/* Triggers a node representation of an event by applying EventFilters and</span>
<span class="cm"> * adding the event to the appropriate queues.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param eventNodeId The NodeId of the node representation of the event which</span>
<span class="cm"> *        should be triggered</span>
<span class="cm"> * @param outEvent the EventId of the new event</span>
<span class="cm"> * @param deleteEventNode Specifies whether the node representation of the event</span>
<span class="cm"> *        should be deleted</span>
<span class="cm"> * @return The StatusCode of the UA_Server_triggerEvent method */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_triggerEvent</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">eventNodeId</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">originId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="o">*</span><span class="n">outEventId</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">deleteEventNode</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* UA_ENABLE_SUBSCRIPTIONS_EVENTS */</span>
</pre></div>
</div>
</section>
<section id="alarms-conditions-experimental">
<h2>Alarms &amp; Conditions (Experimental)<a class="headerlink" href="#alarms-conditions-experimental" title="Link to this heading">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef UA_ENABLE_SUBSCRIPTIONS_ALARMS_CONDITIONS</span>
<span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">UA_TwoStateVariableCallbackType</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">UA_ENTERING_ENABLEDSTATE</span><span class="p">,</span>
<span class="w">  </span><span class="n">UA_ENTERING_ACKEDSTATE</span><span class="p">,</span>
<span class="w">  </span><span class="n">UA_ENTERING_CONFIRMEDSTATE</span><span class="p">,</span>
<span class="w">  </span><span class="n">UA_ENTERING_ACTIVESTATE</span>
<span class="p">}</span><span class="w"> </span><span class="n">UA_TwoStateVariableCallbackType</span><span class="p">;</span>

<span class="cm">/* Callback prototype to set user specific callbacks */</span>
<span class="k">typedef</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="p">(</span><span class="o">*</span><span class="n">UA_TwoStateVariableChangeCallback</span><span class="p">)(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">condition</span><span class="p">);</span>

<span class="cm">/* Create condition instance. The function checks first whether the passed</span>
<span class="cm"> * conditionType is a subType of ConditionType. Then checks whether the</span>
<span class="cm"> * condition source has HasEventSource reference to its parent. If not, a</span>
<span class="cm"> * HasEventSource reference will be created between condition source and server</span>
<span class="cm"> * object. To expose the condition in address space, a hierarchical</span>
<span class="cm"> * ReferenceType should be passed to create the reference to condition source.</span>
<span class="cm"> * Otherwise, UA_NODEID_NULL should be passed to make the condition not exposed.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param conditionId The NodeId of the requested Condition Object. When passing</span>
<span class="cm"> *        UA_NODEID_NUMERIC(X,0) an unused nodeid in namespace X will be used.</span>
<span class="cm"> *        E.g. passing UA_NODEID_NULL will result in a NodeId in namespace 0.</span>
<span class="cm"> * @param conditionType The NodeId of the node representation of the ConditionType</span>
<span class="cm"> * @param conditionName The name of the condition to be created</span>
<span class="cm"> * @param conditionSource The NodeId of the Condition Source (Parent of the Condition)</span>
<span class="cm"> * @param hierarchialReferenceType The NodeId of Hierarchical ReferenceType</span>
<span class="cm"> *                                 between Condition and its source</span>
<span class="cm"> * @param outConditionId The NodeId of the created Condition</span>
<span class="cm"> * @return The StatusCode of the UA_Server_createCondition method */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_createCondition</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionId</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionType</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">conditionName</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionSource</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">hierarchialReferenceType</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outConditionId</span><span class="p">);</span>

<span class="cm">/* The method pair UA_Server_addCondition_begin and _finish splits the</span>
<span class="cm"> * UA_Server_createCondtion in two parts similiar to the</span>
<span class="cm"> * UA_Server_addNode_begin / _finish pair. This is useful if the node shall be</span>
<span class="cm"> * modified before finish the instantiation. For example to add children with</span>
<span class="cm"> * specific NodeIds.</span>
<span class="cm"> * For details refer to the UA_Server_addNode_begin / _finish methods.</span>
<span class="cm"> *</span>
<span class="cm"> * Additionally to UA_Server_addNode_begin UA_Server_addCondition_begin checks</span>
<span class="cm"> * if the passed condition type is a subtype of the OPC UA ConditionType.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param conditionId The NodeId of the requested Condition Object. When passing</span>
<span class="cm"> *        UA_NODEID_NUMERIC(X,0) an unused nodeid in namespace X will be used.</span>
<span class="cm"> *        E.g. passing UA_NODEID_NULL will result in a NodeId in namespace 0.</span>
<span class="cm"> * @param conditionType The NodeId of the node representation of the ConditionType</span>
<span class="cm"> * @param conditionName The name of the condition to be added</span>
<span class="cm"> * @param outConditionId The NodeId of the added Condition</span>
<span class="cm"> * @return The StatusCode of the UA_Server_addCondition_begin method */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addCondition_begin</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                             </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionId</span><span class="p">,</span>
<span class="w">                             </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionType</span><span class="p">,</span>
<span class="w">                             </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">conditionName</span><span class="p">,</span>
<span class="w">                             </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outConditionId</span><span class="p">);</span>

<span class="cm">/* Second call of the UA_Server_addCondition_begin and _finish pair.</span>
<span class="cm"> * Additionally to UA_Server_addNode_finish UA_Server_addCondition_finish:</span>
<span class="cm"> *  - checks whether the condition source has HasEventSource reference to its</span>
<span class="cm"> *    parent. If not, a HasEventSource reference will be created between</span>
<span class="cm"> *    condition source and server object</span>
<span class="cm"> *  - exposes the condition in the address space if hierarchialReferenceType is</span>
<span class="cm"> *    not UA_NODEID_NULL by adding a reference of this type from the condition</span>
<span class="cm"> *    source to the condition instance</span>
<span class="cm"> *  - initializes the standard condition fields and callbacks</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param conditionId The NodeId of the unfinished Condition Object</span>
<span class="cm"> * @param conditionSource The NodeId of the Condition Source (Parent of the Condition)</span>
<span class="cm"> * @param hierarchialReferenceType The NodeId of Hierarchical ReferenceType</span>
<span class="cm"> *                                 between Condition and its source</span>
<span class="cm"> * @return The StatusCode of the UA_Server_addCondition_finish method */</span>

<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addCondition_finish</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionId</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionSource</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">hierarchialReferenceType</span><span class="p">);</span>

<span class="cm">/* Set the value of condition field.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param condition The NodeId of the node representation of the Condition Instance</span>
<span class="cm"> * @param value Variant Value to be written to the Field</span>
<span class="cm"> * @param fieldName Name of the Field in which the value should be written</span>
<span class="cm"> * @return The StatusCode of the UA_Server_setConditionField method*/</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_setConditionField</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">condition</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">fieldName</span><span class="p">);</span>

<span class="cm">/* Set the value of property of condition field.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param condition The NodeId of the node representation of the Condition</span>
<span class="cm"> *        Instance</span>
<span class="cm"> * @param value Variant Value to be written to the Field</span>
<span class="cm"> * @param variableFieldName Name of the Field which has a property</span>
<span class="cm"> * @param variablePropertyName Name of the Field Property in which the value</span>
<span class="cm"> *        should be written</span>
<span class="cm"> * @return The StatusCode of the UA_Server_setConditionVariableFieldProperty*/</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_setConditionVariableFieldProperty</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">condition</span><span class="p">,</span>
<span class="w">                                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">,</span>
<span class="w">                                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">variableFieldName</span><span class="p">,</span>
<span class="w">                                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">variablePropertyName</span><span class="p">);</span>

<span class="cm">/* Triggers an event only for an enabled condition. The condition list is</span>
<span class="cm"> * updated then with the last generated EventId.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param condition The NodeId of the node representation of the Condition Instance</span>
<span class="cm"> * @param conditionSource The NodeId of the node representation of the Condition Source</span>
<span class="cm"> * @param outEventId last generated EventId</span>
<span class="cm"> * @return The StatusCode of the UA_Server_triggerConditionEvent method */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_triggerConditionEvent</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">condition</span><span class="p">,</span>
<span class="w">                                </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionSource</span><span class="p">,</span>
<span class="w">                                </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="o">*</span><span class="n">outEventId</span><span class="p">);</span>

<span class="cm">/* Add an optional condition field using its name. (TODO Adding optional methods</span>
<span class="cm"> * is not implemented yet)</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param condition The NodeId of the node representation of the Condition Instance</span>
<span class="cm"> * @param conditionType The NodeId of the node representation of the Condition Type</span>
<span class="cm"> * from which the optional field comes</span>
<span class="cm"> * @param fieldName Name of the optional field</span>
<span class="cm"> * @param outOptionalVariable The NodeId of the created field (Variable Node)</span>
<span class="cm"> * @return The StatusCode of the UA_Server_addConditionOptionalField method */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addConditionOptionalField</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">condition</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionType</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">fieldName</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">outOptionalVariable</span><span class="p">);</span>

<span class="cm">/* Function used to set a user specific callback to TwoStateVariable Fields of a</span>
<span class="cm"> * condition. The callbacks will be called before triggering the events when</span>
<span class="cm"> * transition to true State of EnabledState/Id, AckedState/Id, ConfirmedState/Id</span>
<span class="cm"> * and ActiveState/Id occurs.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param condition The NodeId of the node representation of the Condition Instance</span>
<span class="cm"> * @param conditionSource The NodeId of the node representation of the Condition Source</span>
<span class="cm"> * @param removeBranch (Not Implemented yet)</span>
<span class="cm"> * @param callback User specific callback function</span>
<span class="cm"> * @param callbackType Callback function type, indicates where it should be called</span>
<span class="cm"> * @return The StatusCode of the UA_Server_setConditionTwoStateVariableCallback method */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_setConditionTwoStateVariableCallback</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                               </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">condition</span><span class="p">,</span>
<span class="w">                                               </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionSource</span><span class="p">,</span>
<span class="w">                                               </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">removeBranch</span><span class="p">,</span>
<span class="w">                                               </span><span class="n">UA_TwoStateVariableChangeCallback</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span>
<span class="w">                                               </span><span class="n">UA_TwoStateVariableCallbackType</span><span class="w"> </span><span class="n">callbackType</span><span class="p">);</span>

<span class="cm">/* Delete a condition from the address space and the internal lists.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param condition The NodeId of the node representation of the Condition Instance</span>
<span class="cm"> * @param conditionSource The NodeId of the node representation of the Condition Source</span>
<span class="cm"> * @return ``UA_STATUSCODE_GOOD`` on success */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_deleteCondition</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">condition</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionSource</span><span class="p">);</span>

<span class="cm">/* Set the LimitState of the LimitAlarmType</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param conditionId NodeId of the node representation of the Condition Instance</span>
<span class="cm"> * @param limitValue The value from the trigger node */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_setLimitState</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionId</span><span class="p">,</span>
<span class="w">                        </span><span class="n">UA_Double</span><span class="w"> </span><span class="n">limitValue</span><span class="p">);</span>

<span class="cm">/* Parse the certifcate and set Expiration date</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param conditionId NodeId of the node representation of the Condition Instance</span>
<span class="cm"> * @param cert The certificate for parsing */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_setExpirationDate</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">conditionId</span><span class="p">,</span>
<span class="w">                            </span><span class="n">UA_ByteString</span><span class="w">  </span><span class="n">cert</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* UA_ENABLE_SUBSCRIPTIONS_ALARMS_CONDITIONS */</span>
</pre></div>
</div>
</section>
<section id="update-the-server-certificate-at-runtime">
<h2>Update the Server Certificate at Runtime<a class="headerlink" href="#update-the-server-certificate-at-runtime" title="Link to this heading">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_updateCertificate</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="o">*</span><span class="n">oldCertificate</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="o">*</span><span class="n">newCertificate</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="o">*</span><span class="n">newPrivateKey</span><span class="p">,</span>
<span class="w">                            </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">closeSessions</span><span class="p">,</span>
<span class="w">                            </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">closeSecureChannels</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="utility-functions">
<h2>Utility Functions<a class="headerlink" href="#utility-functions" title="Link to this heading">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Lookup a datatype by its NodeId. Takes the custom types in the server</span>
<span class="cm"> * configuration into account. Return NULL if none found. */</span>
<span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span>
<span class="nf">UA_Server_findDataType</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">typeId</span><span class="p">);</span>

<span class="cm">/* Add a new namespace to the server. Returns the index of the new namespace */</span>
<span class="n">UA_UInt16</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_addNamespace</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>

<span class="cm">/* Get namespace by name from the server. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_getNamespaceByName</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_String</span><span class="w"> </span><span class="n">namespaceUri</span><span class="p">,</span>
<span class="w">                             </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">foundIndex</span><span class="p">);</span>

<span class="cm">/* Get namespace by id from the server. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Server_getNamespaceByIndex</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">namespaceIndex</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_String</span><span class="w"> </span><span class="o">*</span><span class="n">foundUri</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="id8">
<span id="id9"></span><h2>Async Operations<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h2>
<p>Some operations (such as reading out a sensor that needs to warm up) can take
quite some time. In order not to block the server during such an operation, it
can be “outsourced” to a worker thread.</p>
<p>Take the example of a CallRequest. It is split into the individual method call
operations. If the method is marked as async, then the operation is put into a
queue where it is be retrieved by a worker. The worker returns the result when
ready. See the examples in <code class="docutils literal notranslate"><span class="pre">/examples/tutorial_server_method_async.c</span></code> for
the usage.</p>
<p>Note that the operation can time out (see the asyncOperationTimeout setting in
the server config) also when it has been retrieved by the worker.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#if UA_MULTITHREADING &gt;= 100</span>

<span class="cm">/* Set the async flag in a method node */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_setMethodNodeAsync</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">id</span><span class="p">,</span>
<span class="w">                             </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">isAsync</span><span class="p">);</span>

<span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_ASYNCOPERATIONTYPE_INVALID</span><span class="p">,</span><span class="w"> </span><span class="cm">/* 0, the default */</span>
<span class="w">    </span><span class="n">UA_ASYNCOPERATIONTYPE_CALL</span>
<span class="w">    </span><span class="cm">/* UA_ASYNCOPERATIONTYPE_READ, */</span>
<span class="w">    </span><span class="cm">/* UA_ASYNCOPERATIONTYPE_WRITE, */</span>
<span class="p">}</span><span class="w"> </span><span class="n">UA_AsyncOperationType</span><span class="p">;</span>

<span class="k">typedef</span><span class="w"> </span><span class="k">union</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_CallMethodRequest</span><span class="w"> </span><span class="n">callMethodRequest</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/* UA_ReadValueId readValueId; */</span>
<span class="w">    </span><span class="cm">/* UA_WriteValue writeValue; */</span>
<span class="p">}</span><span class="w"> </span><span class="n">UA_AsyncOperationRequest</span><span class="p">;</span>

<span class="k">typedef</span><span class="w"> </span><span class="k">union</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_CallMethodResult</span><span class="w"> </span><span class="n">callMethodResult</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/* UA_DataValue readResult; */</span>
<span class="w">    </span><span class="cm">/* UA_StatusCode writeResult; */</span>
<span class="p">}</span><span class="w"> </span><span class="n">UA_AsyncOperationResponse</span><span class="p">;</span>

<span class="cm">/* Get the next async operation without blocking</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param type The type of the async operation</span>
<span class="cm"> * @param request Receives pointer to the operation</span>
<span class="cm"> * @param context Receives the pointer to the operation context</span>
<span class="cm"> * @param timeout The timestamp when the operation times out and can</span>
<span class="cm"> *        no longer be returned to the client. The response has to</span>
<span class="cm"> *        be set in UA_Server_setAsyncOperationResult in any case.</span>
<span class="cm"> * @return false if queue is empty, true else */</span>
<span class="n">UA_Boolean</span>
<span class="nf">UA_Server_getAsyncOperationNonBlocking</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                       </span><span class="n">UA_AsyncOperationType</span><span class="w"> </span><span class="o">*</span><span class="n">type</span><span class="p">,</span>
<span class="w">                                       </span><span class="k">const</span><span class="w"> </span><span class="n">UA_AsyncOperationRequest</span><span class="w"> </span><span class="o">**</span><span class="n">request</span><span class="p">,</span>
<span class="w">                                       </span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">UA_DateTime</span><span class="w"> </span><span class="o">*</span><span class="n">timeout</span><span class="p">);</span>

<span class="cm">/* UA_Boolean */</span>
<span class="cm">/* UA_Server_getAsyncOperationBlocking(UA_Server *server, */</span>
<span class="cm">/*                                     UA_AsyncOperationType *type, */</span>
<span class="cm">/*                                     const UA_AsyncOperationRequest **request, */</span>
<span class="cm">/*                                     void **context, UA_DateTime *timeout); */</span>

<span class="cm">/* Submit an async operation result</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param response Pointer to the operation result</span>
<span class="cm"> * @param context Pointer to the operation context */</span>
<span class="kt">void</span>
<span class="nf">UA_Server_setAsyncOperationResult</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                  </span><span class="k">const</span><span class="w"> </span><span class="n">UA_AsyncOperationResponse</span><span class="w"> </span><span class="o">*</span><span class="n">response</span><span class="p">,</span>
<span class="w">                                  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">context</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* !UA_MULTITHREADING &gt;= 100 */</span>
</pre></div>
</div>
</section>
<section id="statistics">
<h2>Statistics<a class="headerlink" href="#statistics" title="Link to this heading">¶</a></h2>
<p>Statistic counters keeping track of the current state of the stack. Counters
are structured per OPC UA communication layer.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">UA_SecureChannelStatistics</span><span class="w"> </span><span class="n">scs</span><span class="p">;</span>
<span class="w">   </span><span class="n">UA_SessionStatistics</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="n">UA_ServerStatistics</span><span class="p">;</span>

<span class="n">UA_ServerStatistics</span>
<span class="nf">UA_Server_getStatistics</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="id10">
<h2>Reverse Connect<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h2>
<p>The reverse connect feature of OPC UA permits the server instead of the
client to establish the connection. The client must expose the listening port
so the server is able to reach it.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* The reverse connect state change callback is called whenever the state of a</span>
<span class="cm"> * reverse connect is changed by a connection attempt, a successful connection</span>
<span class="cm"> * or a connection loss.</span>
<span class="cm"> *</span>
<span class="cm"> * The reverse connect states reflect the state of the secure channel currently</span>
<span class="cm"> * associated with a reverse connect. The state will remain</span>
<span class="cm"> * UA_SECURECHANNELSTATE_CONNECTING while the server attempts repeatedly to</span>
<span class="cm"> * establish a connection. */</span>
<span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">UA_Server_ReverseConnectStateCallback</span><span class="p">)(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                                      </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="n">handle</span><span class="p">,</span>
<span class="w">                                                      </span><span class="n">UA_SecureChannelState</span><span class="w"> </span><span class="n">state</span><span class="p">,</span>
<span class="w">                                                      </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">context</span><span class="p">);</span>

<span class="cm">/* Registers a reverse connect in the server. The server periodically attempts</span>
<span class="cm"> * to establish a connection if the initial connect fails or if the connection</span>
<span class="cm"> * breaks.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param url The URL of the remote client</span>
<span class="cm"> * @param stateCallback The callback which will be called on state changes</span>
<span class="cm"> * @param callbackContext The context for the state callback</span>
<span class="cm"> * @param handle Is set to the handle of the reverse connect if not NULL</span>
<span class="cm"> * @return Returns UA_STATUSCODE_GOOD if the reverse connect has been registered */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_addReverseConnect</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_String</span><span class="w"> </span><span class="n">url</span><span class="p">,</span>
<span class="w">                            </span><span class="n">UA_Server_ReverseConnectStateCallback</span><span class="w"> </span><span class="n">stateCallback</span><span class="p">,</span>
<span class="w">                            </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">callbackContext</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="p">);</span>

<span class="cm">/* Removes a reverse connect from the server and closes the connection if it is</span>
<span class="cm"> * currently open.</span>
<span class="cm"> *</span>
<span class="cm"> * @param server The server object</span>
<span class="cm"> * @param handle The handle of the reverse connect to remove</span>
<span class="cm"> * @return Returns UA_STATUSCODE_GOOD if the reverse connect has been</span>
<span class="cm"> *         successfully removed */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Server_removeReverseConnect</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="types.html" class="btn btn-neutral float-left" title="Data Types" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="client.html" class="btn btn-neutral float-right" title="Client" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>