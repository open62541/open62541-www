<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Client &mdash; open62541 1.4.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=c97b86a3"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Highlevel Client Functionality" href="client_highlevel.html" />
    <link rel="prev" title="Server" href="server.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="toc.html" class="icon icon-home">
            open62541
              <img src="_static/open62541_html.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_concepts.html">Core Concepts of OPC UA</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building open62541</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Server</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Client</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#client-configuration">Client Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#connection-configuration">Connection configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-data-types">Custom Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-client-configuration">Advanced Client Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#client-lifecycle">Client Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connection-attrbiutes">Connection Attrbiutes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connect-to-a-server">Connect to a Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#discovery">Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#services">Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="#asynchronous-services">Asynchronous Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="#timed-callbacks">Timed Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#client-utility-functions">Client Utility Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="client_highlevel.html">Highlevel Client Functionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_highlevel_async.html">Async Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_highlevel_async.html#asynchronous-operations">Asynchronous Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_highlevel_async.html#read-attribute">Read Attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_highlevel_async.html#write-attribute">Write Attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_highlevel_async.html#method-calling">Method Calling</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_highlevel_async.html#node-management">Node Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_subscriptions.html">Subscriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_subscriptions.html#monitoreditems">MonitoredItems</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pubsub.html">PubSub</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="nodeset_compiler.html">XML Nodeset Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="statuscodes.html">StatusCodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugin.html">Plugin API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">open62541</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="toc.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Client</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/client.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="client">
<span id="id1"></span><h1>Client<a class="headerlink" href="#client" title="Link to this heading">¶</a></h1>
<p>The client implementation allows remote access to all OPC UA services. For
convenience, some functionality has been wrapped in <a class="reference internal" href="client_highlevel.html#client-highlevel"><span class="std std-ref">high-level
abstractions</span></a>.</p>
<p><strong>However</strong>: At this time, the client does not yet contain its own thread or
event-driven main-loop, meaning that the client will not perform any actions
automatically in the background. This is especially relevant for
connection/session management and subscriptions. The user will have to
periodically call <cite>UA_Client_run_iterate</cite> to ensure that asynchronous events
are handled, including keeping a secure connection established.
See more about <a class="reference internal" href="#client-async-services"><span class="std std-ref">asynchronicity</span></a> and
<a class="reference internal" href="client_subscriptions.html#client-subscriptions"><span class="std std-ref">subscriptions</span></a>.</p>
<section id="client-configuration">
<span id="client-config"></span><h2>Client Configuration<a class="headerlink" href="#client-configuration" title="Link to this heading">¶</a></h2>
<p>The client configuration is used for setting connection parameters and
additional settings used by the client.
The configuration should not be modified after it is passed to a client.
Currently, only one client can use a configuration at a time.</p>
<p>Examples for configurations are provided in the <code class="docutils literal notranslate"><span class="pre">/plugins</span></code> folder.
The usual usage is as follows:</p>
<ol class="arabic simple">
<li><p>Create a client configuration with default settings as a starting point</p></li>
<li><p>Modifiy the configuration, e.g. modifying the timeout</p></li>
<li><p>Instantiate a client with it</p></li>
<li><p>After shutdown of the client, clean up the configuration (free memory)</p></li>
</ol>
<p>The <a class="reference internal" href="tutorials.html#tutorials"><span class="std std-ref">Tutorials</span></a> provide a good starting point for this.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">UA_ClientConfig</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">clientContext</span><span class="p">;</span><span class="w"> </span><span class="cm">/* User-defined pointer attached to the client */</span>
<span class="w">    </span><span class="n">UA_Logger</span><span class="w"> </span><span class="o">*</span><span class="n">logging</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Plugin for log output */</span>

<span class="w">    </span><span class="cm">/* Response timeout in ms (0 -&gt; no timeout). If the server does not answer a</span>
<span class="cm">     * request within this time a StatusCode UA_STATUSCODE_BADTIMEOUT is</span>
<span class="cm">     * returned. This timeout can be overridden for individual requests by</span>
<span class="cm">     * setting a non-null &quot;timeoutHint&quot; in the request header. */</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">timeout</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* The description must be internally consistent.</span>
<span class="cm">     * - The ApplicationUri set in the ApplicationDescription must match the</span>
<span class="cm">     *   URI set in the certificate */</span>
<span class="w">    </span><span class="n">UA_ApplicationDescription</span><span class="w"> </span><span class="n">clientDescription</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* The endpoint for the client to connect to.</span>
<span class="cm">     * Such as &quot;opc.tcp://host:port&quot;. */</span>
<span class="w">    </span><span class="n">UA_String</span><span class="w"> </span><span class="n">endpointUrl</span><span class="p">;</span>
</pre></div>
</div>
<section id="connection-configuration">
<h3>Connection configuration<a class="headerlink" href="#connection-configuration" title="Link to this heading">¶</a></h3>
<p>The following configuration elements reduce the “degrees of freedom” the
client has when connecting to a server. If no connection can be made
under these restrictions, then the connection will abort with an error
message.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_ExtensionObject</span><span class="w"> </span><span class="n">userIdentityToken</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Configured User-Identity Token */</span>
<span class="n">UA_MessageSecurityMode</span><span class="w"> </span><span class="n">securityMode</span><span class="p">;</span><span class="w">  </span><span class="cm">/* None, Sign, SignAndEncrypt. The</span>
<span class="cm">                                       * default is invalid. This indicates</span>
<span class="cm">                                       * the client to select any matching</span>
<span class="cm">                                       * endpoint. */</span>
<span class="n">UA_String</span><span class="w"> </span><span class="n">securityPolicyUri</span><span class="p">;</span><span class="w"> </span><span class="cm">/* SecurityPolicy for the SecureChannel. An</span>
<span class="cm">                              * empty string indicates the client to select</span>
<span class="cm">                              * any matching SecurityPolicy. */</span>

<span class="n">UA_Boolean</span><span class="w"> </span><span class="n">noSession</span><span class="p">;</span><span class="w">   </span><span class="cm">/* Only open a SecureChannel, but no Session */</span>
<span class="n">UA_Boolean</span><span class="w"> </span><span class="n">noReconnect</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Don&#39;t reconnect SecureChannel when the connection</span>
<span class="cm">                         * is lost without explicitly closing. */</span>
<span class="n">UA_Boolean</span><span class="w"> </span><span class="n">noNewSession</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Don&#39;t automatically create a new Session when</span>
<span class="cm">                          * the intial one is lost. Instead abort the</span>
<span class="cm">                          * connection when the Session is lost. */</span>
</pre></div>
</div>
<p>If either endpoint or userTokenPolicy has been set (at least one non-zero
byte in either structure), then the selected Endpoint and UserTokenPolicy
overwrite the settings in the basic connection configuration. The
userTokenPolicy array in the EndpointDescription is ignored. The selected
userTokenPolicy is set in the dedicated configuration field.</p>
<p>If the advanced configuration is not set, the client will write to it the
selected Endpoint and UserTokenPolicy during GetEndpoints.</p>
<p>The information in the advanced configuration is used during reconnect
when the SecureChannel was broken.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_EndpointDescription</span><span class="w"> </span><span class="n">endpoint</span><span class="p">;</span>
<span class="n">UA_UserTokenPolicy</span><span class="w"> </span><span class="n">userTokenPolicy</span><span class="p">;</span>
</pre></div>
</div>
<p>If the EndpointDescription has not been defined, the ApplicationURI
constrains the servers considered in the FindServers service and the
Endpoints considered in the GetEndpoints service.</p>
<p>If empty the applicationURI is not used to filter.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_String</span><span class="w"> </span><span class="n">applicationUri</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="custom-data-types">
<h3>Custom Data Types<a class="headerlink" href="#custom-data-types" title="Link to this heading">¶</a></h3>
<p>The following is a linked list of arrays with custom data types. All data
types that are accessible from here are automatically considered for the
decoding of received messages. Custom data types are not cleaned up
together with the configuration. So it is possible to allocate them on
ROM.</p>
<p>See the section on <a class="reference internal" href="types.html#generic-types"><span class="std std-ref">Generic Type Handling</span></a>. Examples for working with custom
data types are provided in <code class="docutils literal notranslate"><span class="pre">/examples/custom_datatype/</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataTypeArray</span><span class="w"> </span><span class="o">*</span><span class="n">customDataTypes</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="advanced-client-configuration">
<h3>Advanced Client Configuration<a class="headerlink" href="#advanced-client-configuration" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">secureChannelLifeTime</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Lifetime in ms (then the channel needs</span>
<span class="cm">                                        to be renewed) */</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">requestedSessionTimeout</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Session timeout in ms */</span>
<span class="w">    </span><span class="n">UA_ConnectionConfig</span><span class="w"> </span><span class="n">localConnectionConfig</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">connectivityCheckInterval</span><span class="p">;</span><span class="w">     </span><span class="cm">/* Connectivity check interval in ms.</span>
<span class="cm">                                              * 0 = background task disabled */</span>

<span class="w">    </span><span class="cm">/* EventLoop */</span>
<span class="w">    </span><span class="n">UA_EventLoop</span><span class="w"> </span><span class="o">*</span><span class="n">eventLoop</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">externalEventLoop</span><span class="p">;</span><span class="w"> </span><span class="cm">/* The EventLoop is not deleted with the config */</span>

<span class="w">    </span><span class="cm">/* Available SecurityPolicies */</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">securityPoliciesSize</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_SecurityPolicy</span><span class="w"> </span><span class="o">*</span><span class="n">securityPolicies</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Certificate Verification Plugin */</span>
<span class="w">    </span><span class="n">UA_CertificateVerification</span><span class="w"> </span><span class="n">certificateVerification</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Available SecurityPolicies for Authentication. The policy defined by the</span>
<span class="cm">     * AccessControl is selected. If no policy is defined, the policy of the</span>
<span class="cm">     * secure channel is selected.*/</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">authSecurityPoliciesSize</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_SecurityPolicy</span><span class="w"> </span><span class="o">*</span><span class="n">authSecurityPolicies</span><span class="p">;</span>
<span class="w">    </span><span class="cm">/* SecurityPolicyUri for the Authentication. */</span>
<span class="w">    </span><span class="n">UA_String</span><span class="w"> </span><span class="n">authSecurityPolicyUri</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Callback for state changes. The client state is differentated into the</span>
<span class="cm">     * SecureChannel state and the Session state. The connectStatus is set if</span>
<span class="cm">     * the client connection (including reconnects) has failed and the client</span>
<span class="cm">     * has to &quot;give up&quot;. If the connectStatus is not set, the client still has</span>
<span class="cm">     * hope to connect or recover. */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">stateCallback</span><span class="p">)(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_SecureChannelState</span><span class="w"> </span><span class="n">channelState</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_SessionState</span><span class="w"> </span><span class="n">sessionState</span><span class="p">,</span>
<span class="w">                          </span><span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">connectStatus</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* When connectivityCheckInterval is greater than 0, every</span>
<span class="cm">     * connectivityCheckInterval (in ms), an async read request is performed on</span>
<span class="cm">     * the server. inactivityCallback is called when the client receive no</span>
<span class="cm">     * response for this read request The connection can be closed, this in an</span>
<span class="cm">     * attempt to recreate a healthy connection. */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">inactivityCallback</span><span class="p">)(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* Number of PublishResponse queued up in the server */</span>
<span class="w">    </span><span class="n">UA_UInt16</span><span class="w"> </span><span class="n">outStandingPublishRequests</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* If the client does not receive a PublishResponse after the defined delay</span>
<span class="cm">     * of ``(sub-&gt;publishingInterval * sub-&gt;maxKeepAliveCount) +</span>
<span class="cm">     * client-&gt;config.timeout)``, then subscriptionInactivityCallback is called</span>
<span class="cm">     * for the subscription.. */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">subscriptionInactivityCallback</span><span class="p">)(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                                           </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">subscriptionId</span><span class="p">,</span>
<span class="w">                                           </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">subContext</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* Session config */</span>
<span class="w">    </span><span class="n">UA_String</span><span class="w"> </span><span class="n">sessionName</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_LocaleId</span><span class="w"> </span><span class="o">*</span><span class="n">sessionLocaleIds</span><span class="p">;</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">sessionLocaleIdsSize</span><span class="p">;</span>

<span class="cp">#ifdef UA_ENABLE_ENCRYPTION</span>
<span class="w">    </span><span class="cm">/* If the private key is in PEM format and password protected, this callback</span>
<span class="cm">     * is called during initialization to get the password to decrypt the</span>
<span class="cm">     * private key. The memory containing the password is freed by the client</span>
<span class="cm">     * after use. The callback should be set early, other parts of the client</span>
<span class="cm">     * config setup may depend on it. */</span>
<span class="w">    </span><span class="n">UA_StatusCode</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">privateKeyPasswordCallback</span><span class="p">)(</span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">cc</span><span class="p">,</span>
<span class="w">                                                </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="o">*</span><span class="n">password</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="p">};</span>
</pre></div>
</div>
<p>&#64;brief It makes a partial deep copy of the clientconfig. It makes a shallow
copies of the plugins (logger, eventloop, securitypolicy).</p>
<p>NOTE: It makes a shallow copy of all the plugins from source to destination.
Therefore calling _clear on the dst object will also delete the plugins in src
object.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_StatusCode</span>
<span class="nf">UA_ClientConfig_copy</span><span class="p">(</span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">*</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">dst</span><span class="p">);</span>
</pre></div>
</div>
<p>&#64;brief It cleans the client config and frees the pointer.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span>
<span class="nf">UA_ClientConfig_delete</span><span class="p">(</span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">config</span><span class="p">);</span>
</pre></div>
</div>
<p>&#64;brief It cleans the client config and deletes the plugins, whereas
_copy makes a shallow copy of the plugins.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span>
<span class="nf">UA_ClientConfig_clear</span><span class="p">(</span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">config</span><span class="p">);</span>

<span class="cm">/* Configure Username/Password for the Session authentication. Also see</span>
<span class="cm"> * UA_ClientConfig_setAuthenticationCert for x509-based authentication, which is</span>
<span class="cm"> * implemented as a plugin (as it can be based on different crypto</span>
<span class="cm"> * libraries). */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_ClientConfig_setAuthenticationUsername</span><span class="p">(</span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">config</span><span class="p">,</span>
<span class="w">                                          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">username</span><span class="p">,</span>
<span class="w">                                          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_UserNameIdentityToken</span><span class="o">*</span><span class="w"> </span><span class="n">identityToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_UserNameIdentityToken_new</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">identityToken</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UA_STATUSCODE_BADOUTOFMEMORY</span><span class="p">;</span>
<span class="w">    </span><span class="n">identityToken</span><span class="o">-&gt;</span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_STRING_ALLOC</span><span class="p">(</span><span class="n">username</span><span class="p">);</span>
<span class="w">    </span><span class="n">identityToken</span><span class="o">-&gt;</span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_STRING_ALLOC</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_ExtensionObject_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">config</span><span class="o">-&gt;</span><span class="n">userIdentityToken</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_ExtensionObject_setValue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">config</span><span class="o">-&gt;</span><span class="n">userIdentityToken</span><span class="p">,</span><span class="w"> </span><span class="n">identityToken</span><span class="p">,</span>
<span class="w">                                </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_USERNAMEIDENTITYTOKEN</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">UA_STATUSCODE_GOOD</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="client-lifecycle">
<h2>Client Lifecycle<a class="headerlink" href="#client-lifecycle" title="Link to this heading">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Create a new client with a default configuration that adds plugins for</span>
<span class="cm"> * networking, security, logging and so on. See `client_config_default.h` for</span>
<span class="cm"> * more detailed options.</span>
<span class="cm"> *</span>
<span class="cm"> * The default configuration can be used as the starting point to adjust the</span>
<span class="cm"> * client configuration to individual needs. UA_Client_new is implemented in the</span>
<span class="cm"> * /plugins folder under the CC0 license. Furthermore the client confiugration</span>
<span class="cm"> * only uses the public server API.</span>
<span class="cm"> *</span>
<span class="cm"> * @return Returns the configured client or NULL if an error occurs. */</span>
<span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">UA_Client_new</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/* Creates a new client. Moves the config into the client with a shallow copy.</span>
<span class="cm"> * The config content is cleared together with the client. */</span>
<span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span>
<span class="nf">UA_Client_newWithConfig</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">config</span><span class="p">);</span>

<span class="cm">/* Returns the current state. All arguments except ``client`` can be NULL. */</span>
<span class="kt">void</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Client_getState</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                   </span><span class="n">UA_SecureChannelState</span><span class="w"> </span><span class="o">*</span><span class="n">channelState</span><span class="p">,</span>
<span class="w">                   </span><span class="n">UA_SessionState</span><span class="w"> </span><span class="o">*</span><span class="n">sessionState</span><span class="p">,</span>
<span class="w">                   </span><span class="n">UA_StatusCode</span><span class="w"> </span><span class="o">*</span><span class="n">connectStatus</span><span class="p">);</span>

<span class="cm">/* Get the client configuration */</span>
<span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span>
<span class="nf">UA_Client_getConfig</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">);</span>

<span class="cm">/* Get the client context */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span>
<span class="n">UA_Client_getContext</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">UA_Client_getConfig</span><span class="p">(</span><span class="n">client</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">clientContext</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Cannot fail */</span>
<span class="p">}</span>

<span class="cm">/* (Disconnect and) delete the client */</span>
<span class="kt">void</span>
<span class="n">UA_Client_delete</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="connection-attrbiutes">
<h2>Connection Attrbiutes<a class="headerlink" href="#connection-attrbiutes" title="Link to this heading">¶</a></h2>
<p>Besides the client configuration, some attributes of the connection are
defined only at runtime. For example the choice of SecurityPolicy or the
ApplicationDescripton from the server. This API allows to access such
connection attributes.</p>
<p>The currently defined connection attributes are:</p>
<ul class="simple">
<li><p>0:serverDescription [UA_ApplicationDescription]: Server description</p></li>
<li><p>0:securityPolicyUri [UA_String]: Uri of the SecurityPolicy used</p></li>
<li><p>0:securityMode [UA_MessageSecurityMode]: SecurityMode of the SecureChannel</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Returns a shallow copy of the attribute. Don&#39;t _clear or _delete the value</span>
<span class="cm"> * variant. Don&#39;t use the value after returning the control flow to the client.</span>
<span class="cm"> * Also don&#39;t use this in a multi-threaded application. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Client_getConnectionAttribute</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">                                 </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">outValue</span><span class="p">);</span>

<span class="cm">/* Return a deep copy of the attribute */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_getConnectionAttributeCopy</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">outValue</span><span class="p">);</span>

<span class="cm">/* Returns NULL if the attribute is not defined or not a scalar or not of the</span>
<span class="cm"> * right datatype. Otherwise a shallow copy of the scalar value is created at</span>
<span class="cm"> * the target location of the void pointer. Hence don&#39;t use this in a</span>
<span class="cm"> * multi-threaded application. */</span>
<span class="n">UA_StatusCode</span>
<span class="nf">UA_Client_getConnectionAttribute_scalar</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QualifiedName</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">                                        </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span><span class="n">type</span><span class="p">,</span>
<span class="w">                                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">outValue</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="connect-to-a-server">
<h2>Connect to a Server<a class="headerlink" href="#connect-to-a-server" title="Link to this heading">¶</a></h2>
<p>Once a client is connected to an endpointUrl, it is not possible to switch to
another server. A new client has to be created for that.</p>
<p>Once a connection is established, the client keeps the connection open and
reconnects if necessary.</p>
<p>If the connection fails unrecoverably (state-&gt;connectStatus is set to an
error), the client is no longer usable. Create a new client if required.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Connect with the client configuration. For the async connection, finish</span>
<span class="cm"> * connecting via UA_Client_run_iterate (or manually running a configured</span>
<span class="cm"> * external EventLoop). */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">__UA_Client_connect</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">async</span><span class="p">);</span>

<span class="cm">/* Connect to the server. First a SecureChannel is opened, then a Session. The</span>
<span class="cm"> * client configuration restricts the SecureChannel selection and contains the</span>
<span class="cm"> * UserIdentityToken for the Session.</span>
<span class="cm"> *</span>
<span class="cm"> * @param client to use</span>
<span class="cm"> * @param endpointURL to connect (for example &quot;opc.tcp://localhost:4840&quot;)</span>
<span class="cm"> * @return Indicates whether the operation succeeded or returns an error code */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Client_connect</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">endpointUrl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Update the configuration */</span>
<span class="w">    </span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">cc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_Client_getConfig</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>
<span class="w">    </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">noSession</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Open a Session */</span>
<span class="w">    </span><span class="n">UA_String_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">endpointUrl</span><span class="p">);</span>
<span class="w">    </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">endpointUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_STRING_ALLOC</span><span class="p">(</span><span class="n">endpointUrl</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* Connect */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Client_connect</span><span class="p">(</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Connect async (non-blocking) to the server. After initiating the connection,</span>
<span class="cm"> * call UA_Client_run_iterate repeatedly until the connection is fully</span>
<span class="cm"> * established. You can set a callback to client-&gt;config.stateCallback to be</span>
<span class="cm"> * notified when the connection status changes. Or use UA_Client_getState to get</span>
<span class="cm"> * the state manually. */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Client_connectAsync</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">endpointUrl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Update the configuration */</span>
<span class="w">    </span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">cc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_Client_getConfig</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>
<span class="w">    </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">noSession</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Open a Session */</span>
<span class="w">    </span><span class="n">UA_String_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">endpointUrl</span><span class="p">);</span>
<span class="w">    </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">endpointUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_STRING_ALLOC</span><span class="p">(</span><span class="n">endpointUrl</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* Connect */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Client_connect</span><span class="p">(</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Connect to the server without creating a session</span>
<span class="cm"> *</span>
<span class="cm"> * @param client to use</span>
<span class="cm"> * @param endpointURL to connect (for example &quot;opc.tcp://localhost:4840&quot;)</span>
<span class="cm"> * @return Indicates whether the operation succeeded or returns an error code */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Client_connectSecureChannel</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">endpointUrl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Update the configuration */</span>
<span class="w">    </span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">cc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_Client_getConfig</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>
<span class="w">    </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">noSession</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Don&#39;t open a Session */</span>
<span class="w">    </span><span class="n">UA_String_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">endpointUrl</span><span class="p">);</span>
<span class="w">    </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">endpointUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_STRING_ALLOC</span><span class="p">(</span><span class="n">endpointUrl</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* Connect */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Client_connect</span><span class="p">(</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Connect async (non-blocking) only the SecureChannel */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Client_connectSecureChannelAsync</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">endpointUrl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Update the configuration */</span>
<span class="w">    </span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">cc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_Client_getConfig</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>
<span class="w">    </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">noSession</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Don&#39;t open a Session */</span>
<span class="w">    </span><span class="n">UA_String_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">endpointUrl</span><span class="p">);</span>
<span class="w">    </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">endpointUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_STRING_ALLOC</span><span class="p">(</span><span class="n">endpointUrl</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* Connect */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">__UA_Client_connect</span><span class="p">(</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Connect to the server and create+activate a Session with the given username</span>
<span class="cm"> * and password. This first set the UserIdentityToken in the client config and</span>
<span class="cm"> * then calls the regular connect method. */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Client_connectUsername</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">endpointUrl</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Set the user identity token */</span>
<span class="w">    </span><span class="n">UA_ClientConfig</span><span class="w"> </span><span class="o">*</span><span class="n">cc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_Client_getConfig</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">UA_ClientConfig_setAuthenticationUsername</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">UA_STATUSCODE_GOOD</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Connect */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">UA_Client_connect</span><span class="p">(</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">endpointUrl</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Sets up a listening socket for incoming reverse connect requests by OPC UA</span>
<span class="cm"> * servers. After the first server has connected, the listening socket is</span>
<span class="cm"> * removed. The client state callback is also used for reverse connect. An</span>
<span class="cm"> * implementation could for example issue a new call to</span>
<span class="cm"> * UA_Client_startListeningForReverseConnect after the server has closed the</span>
<span class="cm"> * connection. If the client is connected to any server while</span>
<span class="cm"> * UA_Client_startListeningForReverseConnect is called, the connection will be</span>
<span class="cm"> * closed.</span>
<span class="cm"> *</span>
<span class="cm"> * The reverse connect is closed by calling the standard disconnect functions</span>
<span class="cm"> * like for a &quot;normal&quot; connection that was initiated by the client. Calling one</span>
<span class="cm"> * of the connect methods will also close the listening socket and the</span>
<span class="cm"> * connection to the remote server. */</span>
<span class="n">UA_StatusCode</span>
<span class="n">UA_Client_startListeningForReverseConnect</span><span class="p">(</span>
<span class="w">    </span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_String</span><span class="w"> </span><span class="o">*</span><span class="n">listenHostnames</span><span class="p">,</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">listenHostnamesLength</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt16</span><span class="w"> </span><span class="n">port</span><span class="p">);</span>

<span class="cm">/* Disconnect and close a connection to the selected server. Disconnection is</span>
<span class="cm"> * always performed async (without blocking). */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_disconnect</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">);</span>

<span class="cm">/* Disconnect async. Run UA_Client_run_iterate until the callback notifies that</span>
<span class="cm"> * all connections are closed. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_disconnectAsync</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">);</span>

<span class="cm">/* Disconnect the SecureChannel but keep the Session intact (if it exists). */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_disconnectSecureChannel</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">);</span>

<span class="cm">/* Disconnect the SecureChannel but keep the Session intact (if it exists). This</span>
<span class="cm"> * is an async operation. Iterate the client until the SecureChannel was fully</span>
<span class="cm"> * cleaned up. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_disconnectSecureChannelAsync</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">);</span>

<span class="cm">/* Get the AuthenticationToken and ServerNonce required to activate the current</span>
<span class="cm"> * Session on a different SecureChannel. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_getSessionAuthenticationToken</span><span class="p">(</span>
<span class="w">    </span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">authenticationToken</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="o">*</span><span class="n">serverNonce</span><span class="p">);</span>

<span class="cm">/* Re-activate the current session. A change of prefered locales can be done by</span>
<span class="cm"> * updating the client configuration. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_activateCurrentSession</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">);</span>

<span class="cm">/* Async version of UA_Client_activateCurrentSession */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_activateCurrentSessionAsync</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">);</span>

<span class="cm">/* Activate an already created Session. This allows a Session to be transferred</span>
<span class="cm"> * from a different client instance. The AuthenticationToken and ServerNonce</span>
<span class="cm"> * must be provided for this. Both can be retrieved for an activated Session</span>
<span class="cm"> * with UA_Client_getSessionAuthenticationToken.</span>
<span class="cm"> *</span>
<span class="cm"> * The UserIdentityToken used for authentication must be identical to the</span>
<span class="cm"> * original activation of the Session. The UserIdentityToken is set in the</span>
<span class="cm"> * client configuration.</span>
<span class="cm"> *</span>
<span class="cm"> * Note the noNewSession option if there should not be a new Session</span>
<span class="cm"> * automatically created when this one closes. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_activateSession</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">authenticationToken</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="n">serverNonce</span><span class="p">);</span>

<span class="cm">/* Async version of UA_Client_activateSession */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_activateSessionAsync</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">authenticationToken</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="n">serverNonce</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="discovery">
<h2>Discovery<a class="headerlink" href="#discovery" title="Link to this heading">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Gets a list of endpoints of a server</span>
<span class="cm"> *</span>
<span class="cm"> * @param client to use. Must be connected to the same endpoint given in</span>
<span class="cm"> *        serverUrl or otherwise in disconnected state.</span>
<span class="cm"> * @param serverUrl url to connect (for example &quot;opc.tcp://localhost:4840&quot;)</span>
<span class="cm"> * @param endpointDescriptionsSize size of the array of endpoint descriptions</span>
<span class="cm"> * @param endpointDescriptions array of endpoint descriptions that is allocated</span>
<span class="cm"> *        by the function (you need to free manually)</span>
<span class="cm"> * @return Indicates whether the operation succeeded or returns an error code */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_getEndpoints</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">serverUrl</span><span class="p">,</span>
<span class="w">                       </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">endpointDescriptionsSize</span><span class="p">,</span>
<span class="w">                       </span><span class="n">UA_EndpointDescription</span><span class="o">**</span><span class="w"> </span><span class="n">endpointDescriptions</span><span class="p">);</span>

<span class="cm">/* Gets a list of all registered servers at the given server.</span>
<span class="cm"> *</span>
<span class="cm"> * You can pass an optional filter for serverUris. If the given server is not</span>
<span class="cm"> * registered, an empty array will be returned. If the server is registered,</span>
<span class="cm"> * only that application description will be returned.</span>
<span class="cm"> *</span>
<span class="cm"> * Additionally you can optionally indicate which locale you want for the server</span>
<span class="cm"> * name in the returned application description. The array indicates the order</span>
<span class="cm"> * of preference. A server may have localized names.</span>
<span class="cm"> *</span>
<span class="cm"> * @param client to use. Must be connected to the same endpoint given in</span>
<span class="cm"> *        serverUrl or otherwise in disconnected state.</span>
<span class="cm"> * @param serverUrl url to connect (for example &quot;opc.tcp://localhost:4840&quot;)</span>
<span class="cm"> * @param serverUrisSize Optional filter for specific server uris</span>
<span class="cm"> * @param serverUris Optional filter for specific server uris</span>
<span class="cm"> * @param localeIdsSize Optional indication which locale you prefer</span>
<span class="cm"> * @param localeIds Optional indication which locale you prefer</span>
<span class="cm"> * @param registeredServersSize size of returned array, i.e., number of</span>
<span class="cm"> *        found/registered servers</span>
<span class="cm"> * @param registeredServers array containing found/registered servers</span>
<span class="cm"> * @return Indicates whether the operation succeeded or returns an error code */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_findServers</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">serverUrl</span><span class="p">,</span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">serverUrisSize</span><span class="p">,</span><span class="w"> </span><span class="n">UA_String</span><span class="w"> </span><span class="o">*</span><span class="n">serverUris</span><span class="p">,</span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">localeIdsSize</span><span class="p">,</span><span class="w"> </span><span class="n">UA_String</span><span class="w"> </span><span class="o">*</span><span class="n">localeIds</span><span class="p">,</span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">registeredServersSize</span><span class="p">,</span>
<span class="w">                      </span><span class="n">UA_ApplicationDescription</span><span class="w"> </span><span class="o">**</span><span class="n">registeredServers</span><span class="p">);</span>

<span class="cm">/* Get a list of all known server in the network. Only supported by LDS servers.</span>
<span class="cm"> *</span>
<span class="cm"> * @param client to use. Must be connected to the same endpoint given in</span>
<span class="cm"> * serverUrl or otherwise in disconnected state.</span>
<span class="cm"> * @param serverUrl url to connect (for example &quot;opc.tcp://localhost:4840&quot;)</span>
<span class="cm"> * @param startingRecordId optional. Only return the records with an ID higher</span>
<span class="cm"> *        or equal the given. Can be used for pagination to only get a subset of</span>
<span class="cm"> *        the full list</span>
<span class="cm"> * @param maxRecordsToReturn optional. Only return this number of records</span>

<span class="cm"> * @param serverCapabilityFilterSize optional. Filter the returned list to only</span>
<span class="cm"> *        get servers with given capabilities, e.g. &quot;LDS&quot;</span>
<span class="cm"> * @param serverCapabilityFilter optional. Filter the returned list to only get</span>
<span class="cm"> *        servers with given capabilities, e.g. &quot;LDS&quot;</span>
<span class="cm"> * @param serverOnNetworkSize size of returned array, i.e., number of</span>
<span class="cm"> *        known/registered servers</span>
<span class="cm"> * @param serverOnNetwork array containing known/registered servers</span>
<span class="cm"> * @return Indicates whether the operation succeeded or returns an error code */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_findServersOnNetwork</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">serverUrl</span><span class="p">,</span>
<span class="w">                               </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">startingRecordId</span><span class="p">,</span>
<span class="w">                               </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">maxRecordsToReturn</span><span class="p">,</span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">serverCapabilityFilterSize</span><span class="p">,</span>
<span class="w">                               </span><span class="n">UA_String</span><span class="w"> </span><span class="o">*</span><span class="n">serverCapabilityFilter</span><span class="p">,</span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">serverOnNetworkSize</span><span class="p">,</span>
<span class="w">                               </span><span class="n">UA_ServerOnNetwork</span><span class="w"> </span><span class="o">**</span><span class="n">serverOnNetwork</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="services">
<span id="client-services"></span><h2>Services<a class="headerlink" href="#services" title="Link to this heading">¶</a></h2>
<p>The raw OPC UA services are exposed to the client. But most of the time, it
is better to use the convenience functions from <code class="docutils literal notranslate"><span class="pre">ua_client_highlevel.h</span></code>
that wrap the raw services.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Don&#39;t use this function. Use the type versions below instead. */</span>
<span class="kt">void</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="nf">__UA_Client_Service</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">request</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span><span class="n">requestType</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">response</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span><span class="n">responseType</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Attribute Service Set</span>
<span class="cm"> * ^^^^^^^^^^^^^^^^^^^^^ */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_ReadResponse</span>
<span class="n">UA_Client_Service_read</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_ReadRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_ReadResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_READREQUEST</span><span class="p">],</span>
<span class="w">                        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_READRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_WriteResponse</span>
<span class="n">UA_Client_Service_write</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_WriteRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_WriteResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_WRITEREQUEST</span><span class="p">],</span>
<span class="w">                        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_WRITERESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Historical Access Service Set</span>
<span class="cm"> * ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_HistoryReadResponse</span>
<span class="n">UA_Client_Service_historyRead</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_HistoryReadRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_HistoryReadResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_HISTORYREADREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_HISTORYREADRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_HistoryUpdateResponse</span>
<span class="n">UA_Client_Service_historyUpdate</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                                </span><span class="k">const</span><span class="w"> </span><span class="n">UA_HistoryUpdateRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_HistoryUpdateResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_HISTORYUPDATEREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_HISTORYUPDATERESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Method Service Set</span>
<span class="cm"> * ^^^^^^^^^^^^^^^^^^ */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_CallResponse</span>
<span class="n">UA_Client_Service_call</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                       </span><span class="k">const</span><span class="w"> </span><span class="n">UA_CallRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_CallResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_CALLREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_CALLRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * NodeManagement Service Set</span>
<span class="cm"> * ^^^^^^^^^^^^^^^^^^^^^^^^^^ */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_AddNodesResponse</span>
<span class="n">UA_Client_Service_addNodes</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                           </span><span class="k">const</span><span class="w"> </span><span class="n">UA_AddNodesRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_AddNodesResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_ADDNODESREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_ADDNODESRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_AddReferencesResponse</span>
<span class="n">UA_Client_Service_addReferences</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                                </span><span class="k">const</span><span class="w"> </span><span class="n">UA_AddReferencesRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_AddReferencesResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_ADDREFERENCESREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_ADDREFERENCESRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_DeleteNodesResponse</span>
<span class="n">UA_Client_Service_deleteNodes</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                              </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DeleteNodesRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_DeleteNodesResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DELETENODESREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DELETENODESRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_DeleteReferencesResponse</span>
<span class="n">UA_Client_Service_deleteReferences</span><span class="p">(</span>
<span class="w">    </span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DeleteReferencesRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_DeleteReferencesResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DELETEREFERENCESREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_DELETEREFERENCESRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * View Service Set</span>
<span class="cm"> * ^^^^^^^^^^^^^^^^ */</span>
<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_BrowseResponse</span>
<span class="n">UA_Client_Service_browse</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">UA_BrowseRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_BrowseResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BROWSEREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BROWSERESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_BrowseNextResponse</span>
<span class="n">UA_Client_Service_browseNext</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                             </span><span class="k">const</span><span class="w"> </span><span class="n">UA_BrowseNextRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_BrowseNextResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BROWSENEXTREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_BROWSENEXTRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_TranslateBrowsePathsToNodeIdsResponse</span>
<span class="n">UA_Client_Service_translateBrowsePathsToNodeIds</span><span class="p">(</span>
<span class="w">    </span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">UA_TranslateBrowsePathsToNodeIdsRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_TranslateBrowsePathsToNodeIdsResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_TRANSLATEBROWSEPATHSTONODEIDSREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_TRANSLATEBROWSEPATHSTONODEIDSRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_RegisterNodesResponse</span>
<span class="n">UA_Client_Service_registerNodes</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                                </span><span class="k">const</span><span class="w"> </span><span class="n">UA_RegisterNodesRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_RegisterNodesResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_REGISTERNODESREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_REGISTERNODESRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_UnregisterNodesResponse</span>
<span class="n">UA_Client_Service_unregisterNodes</span><span class="p">(</span>
<span class="w">    </span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_UnregisterNodesRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_UnregisterNodesResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_UNREGISTERNODESREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_UNREGISTERNODESRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Query Service Set</span>
<span class="cm"> * ^^^^^^^^^^^^^^^^^ */</span>
<span class="cp">#ifdef UA_ENABLE_QUERY</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_QueryFirstResponse</span>
<span class="n">UA_Client_Service_queryFirst</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                             </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QueryFirstRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_QueryFirstResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_QUERYFIRSTREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_QUERYFIRSTRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">UA_INLINE</span><span class="w"> </span><span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_QueryNextResponse</span>
<span class="n">UA_Client_Service_queryNext</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">UA_QueryNextRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_QueryNextResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="w">    </span><span class="n">__UA_Client_Service</span><span class="p">(</span>
<span class="w">        </span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_QUERYFIRSTREQUEST</span><span class="p">],</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES</span><span class="p">[</span><span class="n">UA_TYPES_QUERYFIRSTRESPONSE</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#endif</span>
</pre></div>
</div>
</section>
<section id="asynchronous-services">
<span id="client-async-services"></span><h2>Asynchronous Services<a class="headerlink" href="#asynchronous-services" title="Link to this heading">¶</a></h2>
<p>All OPC UA services are asynchronous in nature. So several service calls can
be made without waiting for the individual responses. Depending on the
server’s priorities responses may come in a different ordering than sent. Use
the typed wrappers for async service requests instead of
<cite>__UA_Client_AsyncService</cite> directly. See <a class="reference internal" href="client_highlevel_async.html#client-async"><span class="std std-ref">Async Services</span></a>. However, the
general mechanism of async service calls is explained here.</p>
<p>Connection and session management are performed in <cite>UA_Client_run_iterate</cite>,
so to keep a connection healthy any client needs to consider how and when it
is appropriate to do the call. This is especially true for the periodic
renewal of a SecureChannel’s SecurityToken which is designed to have a
limited lifetime and will invalidate the connection if not renewed.</p>
<p>We say that an async service call has been dispatched once
__UA_Client_AsyncService returns UA_STATUSCODE_GOOD. If there is an error
after an async service has been dispatched, the callback is called with an
“empty” response where the StatusCode has been set accordingly. This is also
done if the client is shutting down and the list of dispatched async services
is emptied.</p>
<p>The StatusCode received when the client is shutting down is
UA_STATUSCODE_BADSHUTDOWN. The StatusCode received when the client doesn’t
receive response after the specified in config-&gt;timeout (can be overridden
via the “timeoutHint” in the request header) is UA_STATUSCODE_BADTIMEOUT.</p>
<p>The userdata and requestId arguments can be NULL. The (optional) requestId
output can be used to cancel the service while it is still pending. The
requestId is unique for each service request. Alternatively the requestHandle
can be manually set (non necessarily unique) in the request header for full
service call. This can be used to cancel all outstanding requests using that
handle together. Note that the client will auto-generate a requestHandle
&gt;100,000 if none is defined. Avoid these when manually setting a requetHandle
in the requestHeader to avoid clashes.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span>
<span class="p">(</span><span class="o">*</span><span class="n">UA_ClientAsyncServiceCallback</span><span class="p">)(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userdata</span><span class="p">,</span>
<span class="w">                                 </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">requestId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">response</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">__UA_Client_AsyncService</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">request</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span><span class="n">requestType</span><span class="p">,</span>
<span class="w">                         </span><span class="n">UA_ClientAsyncServiceCallback</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span><span class="n">responseType</span><span class="p">,</span>
<span class="w">                         </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userdata</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="o">*</span><span class="n">requestId</span><span class="p">);</span>

<span class="cm">/* Cancel all dispatched requests with the given requestHandle.</span>
<span class="cm"> * The number if cancelled requests is returned by the server.</span>
<span class="cm"> * The output argument cancelCount is not set if NULL. */</span>
<span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Client_cancelByRequestHandle</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">requestHandle</span><span class="p">,</span>
<span class="w">                                </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="o">*</span><span class="n">cancelCount</span><span class="p">);</span>

<span class="cm">/* Map the requestId to the requestHandle used for that request and call the</span>
<span class="cm"> * Cancel service for that requestHandle. */</span>
<span class="n">UA_THREADSAFE</span><span class="w"> </span><span class="n">UA_StatusCode</span>
<span class="n">UA_Client_cancelByRequestId</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">requestId</span><span class="p">,</span>
<span class="w">                            </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="o">*</span><span class="n">cancelCount</span><span class="p">);</span>

<span class="cm">/* Set new userdata and callback for an existing request.</span>
<span class="cm"> *</span>
<span class="cm"> * @param client Pointer to the UA_Client</span>
<span class="cm"> * @param requestId RequestId of the request, which was returned by</span>
<span class="cm"> *        __UA_Client_AsyncService before</span>
<span class="cm"> * @param userdata The new userdata</span>
<span class="cm"> * @param callback The new callback</span>
<span class="cm"> * @return UA_StatusCode UA_STATUSCODE_GOOD on success</span>
<span class="cm"> *         UA_STATUSCODE_BADNOTFOUND when no request with requestId is found. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_modifyAsyncCallback</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">requestId</span><span class="p">,</span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userdata</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ClientAsyncServiceCallback</span><span class="w"> </span><span class="n">callback</span><span class="p">);</span>

<span class="cm">/* Listen on the network and process arriving asynchronous responses in the</span>
<span class="cm"> * background. Internal housekeeping, renewal of SecureChannels and subscription</span>
<span class="cm"> * management is done as well. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_run_iterate</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt32</span><span class="w"> </span><span class="n">timeout</span><span class="p">);</span>

<span class="cm">/* Force the manual renewal of the SecureChannel. This is useful to renew the</span>
<span class="cm"> * SecureChannel during a downtime when no time-critical operations are</span>
<span class="cm"> * performed. This method is asynchronous. The renewal is triggered (the OPN</span>
<span class="cm"> * message is sent) but not completed. The OPN response is handled with</span>
<span class="cm"> * ``UA_Client_run_iterate`` or a synchronous service-call operation.</span>
<span class="cm"> *</span>
<span class="cm"> * @return The return value is UA_STATUSCODE_GOODCALLAGAIN if the SecureChannel</span>
<span class="cm"> *         has not elapsed at least 75% of its lifetime. Otherwise the</span>
<span class="cm"> *         ``connectStatus`` is returned. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_renewSecureChannel</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="timed-callbacks">
<h2>Timed Callbacks<a class="headerlink" href="#timed-callbacks" title="Link to this heading">¶</a></h2>
<p>Repeated callbacks can be attached to a client and will be executed in the
defined interval.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">UA_ClientCallback</span><span class="p">)(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">);</span>

<span class="cm">/* Add a callback for execution at a specified time. If the indicated time lies</span>
<span class="cm"> * in the past, then the callback is executed at the next iteration of the</span>
<span class="cm"> * server&#39;s main loop.</span>
<span class="cm"> *</span>
<span class="cm"> * @param client The client object.</span>
<span class="cm"> * @param callback The callback that shall be added.</span>
<span class="cm"> * @param data Data that is forwarded to the callback.</span>
<span class="cm"> * @param date The timestamp for the execution time.</span>
<span class="cm"> * @param callbackId Set to the identifier of the repeated callback. This can</span>
<span class="cm"> *        be used to cancel the callback later on. If the pointer is null, the</span>
<span class="cm"> *        identifier is not set.</span>
<span class="cm"> * @return Upon success, UA_STATUSCODE_GOOD is returned. An error code</span>
<span class="cm"> *         otherwise. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_addTimedCallback</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ClientCallback</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span>
<span class="w">                           </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">UA_DateTime</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="o">*</span><span class="n">callbackId</span><span class="p">);</span>

<span class="cm">/* Add a callback for cyclic repetition to the client.</span>
<span class="cm"> *</span>
<span class="cm"> * @param client The client object.</span>
<span class="cm"> * @param callback The callback that shall be added.</span>
<span class="cm"> * @param data Data that is forwarded to the callback.</span>
<span class="cm"> * @param interval_ms The callback shall be repeatedly executed with the given</span>
<span class="cm"> *        interval (in ms). The interval must be positive. The first execution</span>
<span class="cm"> *        occurs at now() + interval at the latest.</span>
<span class="cm"> * @param callbackId Set to the identifier of the repeated callback. This can</span>
<span class="cm"> *        be used to cancel the callback later on. If the pointer is null, the</span>
<span class="cm"> *        identifier is not set.</span>
<span class="cm"> * @return Upon success, UA_STATUSCODE_GOOD is returned. An error code</span>
<span class="cm"> *         otherwise. */</span>
<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_addRepeatedCallback</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">UA_ClientCallback</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Double</span><span class="w"> </span><span class="n">interval_ms</span><span class="p">,</span>
<span class="w">                              </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="o">*</span><span class="n">callbackId</span><span class="p">);</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="n">UA_Client_changeRepeatedCallbackInterval</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span>
<span class="w">                                         </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="n">callbackId</span><span class="p">,</span>
<span class="w">                                         </span><span class="n">UA_Double</span><span class="w"> </span><span class="n">interval_ms</span><span class="p">);</span>

<span class="kt">void</span><span class="w"> </span><span class="n">UA_THREADSAFE</span>
<span class="nf">UA_Client_removeCallback</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="n">UA_UInt64</span><span class="w"> </span><span class="n">callbackId</span><span class="p">);</span>

<span class="cp">#define UA_Client_removeRepeatedCallback(server, callbackId)    \</span>
<span class="cp">    UA_Client_removeCallback(server, callbackId);</span>
</pre></div>
</div>
</section>
<section id="client-utility-functions">
<h2>Client Utility Functions<a class="headerlink" href="#client-utility-functions" title="Link to this heading">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Lookup a datatype by its NodeId. Takes the custom types in the client</span>
<span class="cm"> * configuration into account. Return NULL if none found. */</span>
<span class="k">const</span><span class="w"> </span><span class="n">UA_DataType</span><span class="w"> </span><span class="o">*</span>
<span class="nf">UA_Client_findDataType</span><span class="p">(</span><span class="n">UA_Client</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">typeId</span><span class="p">);</span>
</pre></div>
</div>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="client_highlevel.html">Highlevel Client Functionality</a><ul>
<li class="toctree-l2"><a class="reference internal" href="client_highlevel.html#read-attributes">Read Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="client_highlevel.html#historical-access">Historical Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="client_highlevel.html#write-attributes">Write Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="client_highlevel.html#method-calling">Method Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="client_highlevel.html#node-management">Node Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="client_highlevel.html#misc-highlevel-functionality">Misc Highlevel Functionality</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="client_highlevel_async.html">Async Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="client_highlevel_async.html#asynchronous-operations">Asynchronous Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="client_highlevel_async.html#read-attribute">Read Attribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="client_highlevel_async.html#write-attribute">Write Attribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="client_highlevel_async.html#method-calling">Method Calling</a></li>
<li class="toctree-l1"><a class="reference internal" href="client_highlevel_async.html#node-management">Node Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="client_subscriptions.html">Subscriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="client_subscriptions.html#monitoreditems">MonitoredItems</a></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="server.html" class="btn btn-neutral float-left" title="Server" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="client_highlevel.html" class="btn btn-neutral float-right" title="Highlevel Client Functionality" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>